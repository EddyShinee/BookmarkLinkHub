import{r as x,j as e,c as N,a as y}from"./globals-SoA60Zn6.js";import{d as w,u as k,g as _,e as T,f as C,a as A,b as P,c as L,S}from"./totp-Cd1Vogd2.js";const f="src/newtab/index.html",g=30;function E(){var d;const{session:s,loading:c}=w(),r=k(),l=_(r.locale),m=(d=s==null?void 0:s.user)==null?void 0:d.id,[n,i]=x.useState("bookmarks"),o=x.useCallback(t=>{const a=t?chrome.runtime.getURL(f)+t:chrome.runtime.getURL(f);chrome.tabs.create({url:a})},[]),u=x.useCallback(()=>{chrome.tabs.query({active:!0,currentWindow:!0},t=>{const a=t[0];if(a!=null&&a.url&&!a.url.startsWith("chrome://")){const b=new URLSearchParams({add:"1",url:a.url,title:a.title??""});o("?"+b.toString())}})},[o]),h=x.useCallback(()=>{var t,a;(a=(t=chrome.runtime).openOptionsPage)==null||a.call(t)},[]);return c?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-[#151b28]",children:e.jsx("div",{className:"animate-pulse text-[#90a4cb] text-sm",children:"Loading..."})}):e.jsxs("div",{className:"w-[360px] h-[500px] bg-[#151b28] rounded-xl shadow-2xl border border-white/5 overflow-hidden flex flex-col font-display",children:[e.jsxs("header",{className:"flex items-center justify-between px-4 py-3 bg-[#151b28]/95 backdrop-blur-sm border-b border-white/5 z-20 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-7 h-7 bg-[#256af4] rounded-lg flex items-center justify-center shadow-lg shadow-blue-900/20",children:e.jsx("span",{className:"material-symbols-outlined text-white text-[18px]",children:"hub"})}),e.jsx("h1",{className:"text-white text-base font-bold tracking-tight",children:"LinkHub"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>o(),className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white rounded-lg hover:bg-white/5 transition-all","aria-label":l.settings,children:e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"search"})}),e.jsx("button",{type:"button",onClick:h,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white rounded-lg hover:bg-white/5 transition-all","aria-label":l.settings,children:e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"settings"})})]})]}),e.jsx("nav",{className:"flex items-center bg-[#151b28] border-b border-white/5 z-10 shrink-0",children:[{id:"bookmarks",icon:"bookmarks",label:"Bookmarks"},{id:"it-tools",icon:"terminal",label:"IT Tools"},{id:"authenticator",icon:"lock",label:"Authenticator"}].map(t=>e.jsxs("button",{type:"button",onClick:()=>i(t.id),className:`flex-1 py-2.5 flex flex-col items-center justify-center gap-0.5 transition-colors group relative ${n===t.id?"text-[#256af4] bg-white/[0.02]":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}`,children:[e.jsx("span",{className:`material-symbols-outlined text-[20px] transition-transform ${n===t.id?"material-symbols-filled":"group-hover:-translate-y-0.5"}`,children:t.icon}),e.jsx("span",{className:"text-[10px] font-medium tracking-wide",children:t.label}),n===t.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#256af4] shadow-[0_-2px_6px_rgba(37,106,244,0.4)]"})]},t.id))}),e.jsxs("main",{className:"flex-1 overflow-y-auto px-2 pt-2 pb-20 relative min-h-0",children:[n==="bookmarks"&&e.jsx(I,{userId:m,openNewTab:o,addCurrentPage:u,t:l}),n==="it-tools"&&e.jsx(R,{openNewTab:o,t:l}),n==="authenticator"&&e.jsx(B,{userId:m,openNewTab:o,t:l})]})]})}function I({userId:s,openNewTab:c,addCurrentPage:r,t:l}){var h;const{boards:m,loading:n}=T(s),i=((h=m[0])==null?void 0:h.id)??null,{categories:o,loading:u}=C(i);return s?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 px-1 pb-2",children:[e.jsx("button",{type:"button",onClick:()=>c(),className:"flex-1 py-2 px-3 rounded-lg bg-[#256af4] text-white text-xs font-medium hover:bg-blue-600 shadow-[0_0_20px_-5px_rgba(37,106,244,0.5)]",children:"Mở trang Dấu trang"}),e.jsx("button",{type:"button",onClick:r,className:"flex-1 py-2 px-3 rounded-lg border border-white/10 text-[#90a4cb] text-xs font-medium hover:bg-white/5 hover:text-white",children:"Thêm trang này"})]}),n||u?e.jsx("p",{className:"text-[#90a4cb] text-sm py-4",children:"Đang tải..."}):o.length===0?e.jsx("p",{className:"text-[#90a4cb] text-sm py-4",children:"Chưa có category. Mở LinkHub để thêm."}):e.jsx("div",{className:"space-y-4",children:o.map(d=>e.jsxs("section",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 sticky top-0 bg-[#151b28]/95 backdrop-blur-sm z-10",children:[e.jsx("span",{className:"material-symbols-outlined text-[16px] text-[#256af4]",children:"folder"}),e.jsx("h3",{className:"text-[#90a4cb] text-xs font-semibold uppercase tracking-wider truncate",children:d.name||"Unnamed"})]}),(d.bookmarks??[]).length===0?e.jsx("p",{className:"text-[#64748b] text-[11px] px-3 py-1",children:"Trống"}):e.jsx("div",{className:"space-y-0.5",children:(d.bookmarks??[]).map(t=>e.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 rounded-xl hover:bg-[#1e2532] transition-colors border border-transparent hover:border-white/5 group",onClick:a=>{a.preventDefault(),chrome.tabs.create({url:t.url})},children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("span",{className:"text-white font-semibold text-sm truncate block",children:t.title||"Untitled"}),e.jsx("span",{className:"text-[#90a4cb] text-[11px] truncate block",children:new URL(t.url).hostname})]}),e.jsx("span",{className:"material-symbols-outlined text-[18px] text-gray-500 group-hover:text-[#256af4]",children:"open_in_new"})]},t.id))})]},d.id))})]}):e.jsxs("div",{className:"py-6 px-3 text-center",children:[e.jsx("p",{className:"text-[#90a4cb] text-sm mb-4",children:"Đăng nhập để xem bookmark."}),e.jsx("button",{type:"button",onClick:()=>c(),className:"py-2 px-4 rounded-lg bg-[#256af4] text-white text-sm font-medium hover:bg-blue-600",children:"Mở LinkHub"})]})}function R({openNewTab:s,t:c}){return e.jsxs("div",{className:"py-6 px-3 text-center",children:[e.jsx("p",{className:"text-[#90a4cb] text-sm mb-4",children:"Mở trang LinkHub để sử dụng IT Tools (JSON, Base64, Hash, ...)."}),e.jsx("button",{type:"button",onClick:()=>s("?open=it-tools"),className:"py-2.5 px-5 rounded-lg bg-[#256af4] text-white text-sm font-medium hover:bg-blue-600 shadow-[0_0_20px_-5px_rgba(37,106,244,0.5)]",children:"Mở IT Tools"})]})}function B({userId:s,openNewTab:c,t:r}){const{entries:l,loading:m}=A(s),[,n]=x.useState(0);return x.useEffect(()=>{const i=setInterval(()=>n(o=>o+1),1e3);return()=>clearInterval(i)},[]),s?m?e.jsx("p",{className:"text-[#90a4cb] text-sm py-6 px-3",children:"Đang tải..."}):l.length===0?e.jsxs("div",{className:"py-6 px-3 text-center",children:[e.jsx("p",{className:"text-[#90a4cb] text-sm mb-4",children:r.noAccountsYet}),e.jsx("button",{type:"button",onClick:()=>c("?open=authenticator"),className:"py-2.5 px-5 rounded-lg bg-[#256af4] text-white text-sm font-medium hover:bg-blue-600 shadow-[0_0_20px_-5px_rgba(37,106,244,0.5)]",children:r.addAccount})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-1 pb-2",children:l.slice(0,20).map(i=>e.jsx(U,{entry:i,t:r},i.id))}),e.jsx("div",{className:"absolute bottom-5 right-5 z-20",children:e.jsx("button",{type:"button",onClick:()=>c("?open=authenticator"),className:"w-12 h-12 bg-[#256af4] rounded-full shadow-[0_0_20px_-5px_rgba(37,106,244,0.5)] flex items-center justify-center text-white hover:bg-blue-600 active:scale-95 transition-all group","aria-label":r.addAccount,children:e.jsx("span",{className:"material-symbols-outlined text-[24px] group-hover:rotate-90 transition-transform duration-300",children:"add"})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-20 bg-gradient-to-t from-[#151b28] to-transparent pointer-events-none z-10","aria-hidden":!0})]}):e.jsxs("div",{className:"py-6 px-3 text-center",children:[e.jsx("p",{className:"text-[#90a4cb] text-sm mb-4",children:r.loginToUseAuthenticator}),e.jsx("button",{type:"button",onClick:()=>c(),className:"py-2 px-4 rounded-lg bg-[#256af4] text-white text-sm font-medium hover:bg-blue-600",children:"Đăng nhập"})]})}function U({entry:s,t:c}){const[r,l]=x.useState("------"),[m,n]=x.useState(!1),i=L(g),o=i/g*100,u=i<=5,h=8.5,d=2*Math.PI*h,t=d-o/100*d;x.useEffect(()=>{let p=!1;return P(s.secret,g).then(v=>{p||l(v)}).catch(()=>{p||l("------")}),()=>{p=!0}},[s.secret,i]);const a=()=>{r!=="------"&&(navigator.clipboard.writeText(r),n(!0),setTimeout(()=>n(!1),1500))},b=r!=="------"?`${r.slice(0,3)} ${r.slice(3)}`:"------",j=(s.issuer||s.account_name||"A").charAt(0).toUpperCase();return e.jsxs("div",{role:"button",tabIndex:0,className:"group relative flex items-center justify-between p-3 rounded-xl hover:bg-[#1e2532] transition-colors cursor-pointer border border-transparent hover:border-white/5",onClick:a,onKeyDown:p=>p.key==="Enter"&&a(),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"shrink-0 w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center overflow-hidden shadow-sm",children:e.jsx("span",{className:"text-white font-bold text-base",children:j})}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-white font-semibold text-sm truncate",children:s.issuer||"Account"}),e.jsx("span",{className:"text-[#90a4cb] text-[11px] truncate",children:s.account_name||""})]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[e.jsx("span",{className:`font-mono font-medium text-base tracking-wider transition-colors ${u?"text-red-400 animate-pulse":"text-white group-hover:text-[#256af4]"}`,children:b}),e.jsx("div",{className:"relative w-[22px] h-[22px] flex items-center justify-center",title:`${i}s`,children:e.jsxs("svg",{className:"transform -rotate-90 w-full h-full",viewBox:"0 0 22 22",children:[e.jsx("circle",{cx:"11",cy:"11",fill:"transparent",r:h,stroke:"#2d3748",strokeWidth:"2"}),e.jsx("circle",{className:"transition-all duration-1000",cx:"11",cy:"11",fill:"transparent",r:h,stroke:u?"#ef4444":"currentColor",strokeDasharray:d,strokeDashoffset:t,strokeLinecap:"round",strokeWidth:"2",style:{color:"#256af4"}})]})})]}),m&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#1e2532]/95 rounded-xl pointer-events-none border border-white/10",children:e.jsxs("span",{className:"text-[#256af4] font-medium text-xs flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"content_copy"}),c.copied]})})]})}N.createRoot(document.getElementById("root")).render(e.jsx(y.StrictMode,{children:e.jsx(S,{children:e.jsx(E,{})})}));
