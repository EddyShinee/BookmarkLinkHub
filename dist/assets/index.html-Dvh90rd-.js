const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jsQR-CSvrzA8D.js","assets/globals-SoA60Zn6.js","assets/globals-BYITNbgL.css"])))=>i.map(i=>d[i]);
import{r as l,R as vs,a as V,b as pt,j as r,c as ys}from"./globals-SoA60Zn6.js";import{u as dt,g as de,s as Xt,B as ws,a as jr,b as js,c as Ns,d as Nr,e as Cs,f as Ss,h as K,S as ks}from"./totp-Cd1Vogd2.js";/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Dt.apply(this,arguments)}var et;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(et||(et={}));const Xn="popstate";function Es(e){e===void 0&&(e={});function t(a,o){let{pathname:i="/",search:c="",hash:d=""}=ut(a.location.hash.substr(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),jn("",{pathname:i,search:c,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(a,o){let i=a.document.querySelector("base"),c="";if(i&&i.getAttribute("href")){let d=a.location.href,u=d.indexOf("#");c=u===-1?d:d.slice(0,u)}return c+"#"+(typeof o=="string"?o:Yt(o))}function s(a,o){nn(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return Rs(t,n,s,e)}function le(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Ds(){return Math.random().toString(36).substr(2,8)}function Yn(e,t){return{usr:e.state,key:e.key,idx:t}}function jn(e,t,n,s){return n===void 0&&(n=null),Dt({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ut(t):t,{state:n,key:t&&t.key||s||Ds()})}function Yt(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function ut(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function Rs(e,t,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:o=!1}=s,i=a.history,c=et.Pop,d=null,u=f();u==null&&(u=0,i.replaceState(Dt({},i.state,{idx:u}),""));function f(){return(i.state||{idx:null}).idx}function h(){c=et.Pop;let m=f(),j=m==null?null:m-u;u=m,d&&d({action:c,location:b.location,delta:j})}function p(m,j){c=et.Push;let S=jn(b.location,m,j);n&&n(S,m),u=f()+1;let w=Yn(S,u),D=b.createHref(S);try{i.pushState(w,"",D)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;a.location.assign(D)}o&&d&&d({action:c,location:b.location,delta:1})}function g(m,j){c=et.Replace;let S=jn(b.location,m,j);n&&n(S,m),u=f();let w=Yn(S,u),D=b.createHref(S);i.replaceState(w,"",D),o&&d&&d({action:c,location:b.location,delta:0})}function N(m){let j=a.location.origin!=="null"?a.location.origin:a.location.href,S=typeof m=="string"?m:Yt(m);return S=S.replace(/ $/,"%20"),le(j,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,j)}let b={get action(){return c},get location(){return e(a,i)},listen(m){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(Xn,h),d=m,()=>{a.removeEventListener(Xn,h),d=null}},createHref(m){return t(a,m)},createURL:N,encodeLocation(m){let j=N(m);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:p,replace:g,go(m){return i.go(m)}};return b}var Vn;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Vn||(Vn={}));function Os(e,t,n){return n===void 0&&(n="/"),Is(e,t,n)}function Is(e,t,n,s){let a=typeof t=="string"?ut(t):t,o=On(a.pathname||"/",n);if(o==null)return null;let i=Cr(e);Ms(i);let c=null;for(let d=0;c==null&&d<i.length;++d){let u=Ws(o);c=Fs(i[d],u)}return c}function Cr(e,t,n,s){t===void 0&&(t=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(o,i,c)=>{let d={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};d.relativePath.startsWith("/")&&(le(d.relativePath.startsWith(s),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(s.length));let u=tt([s,d.relativePath]),f=n.concat(d);o.children&&o.children.length>0&&(le(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Cr(o.children,t,f,u)),!(o.path==null&&!o.index)&&t.push({path:u,score:$s(u,o.index),routesMeta:f})};return e.forEach((o,i)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,i);else for(let d of Sr(o.path))a(o,i,d)}),t}function Sr(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(s.length===0)return a?[o,""]:[o];let i=Sr(s.join("/")),c=[];return c.push(...i.map(d=>d===""?o:[o,d].join("/"))),a&&c.push(...i),c.map(d=>e.startsWith("/")&&d===""?"/":d)}function Ms(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Us(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const Ts=/^:[\w-]+$/,_s=3,As=2,Ls=1,Ps=10,Bs=-2,Qn=e=>e==="*";function $s(e,t){let n=e.split("/"),s=n.length;return n.some(Qn)&&(s+=Bs),t&&(s+=As),n.filter(a=>!Qn(a)).reduce((a,o)=>a+(Ts.test(o)?_s:o===""?Ls:Ps),s)}function Us(e,t){return e.length===t.length&&e.slice(0,-1).every((s,a)=>s===t[a])?e[e.length-1]-t[t.length-1]:0}function Fs(e,t,n){let{routesMeta:s}=e,a={},o="/",i=[];for(let c=0;c<s.length;++c){let d=s[c],u=c===s.length-1,f=o==="/"?t:t.slice(o.length)||"/",h=zs({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},f),p=d.route;if(!h)return null;Object.assign(a,h.params),i.push({params:a,pathname:tt([o,h.pathname]),pathnameBase:Ys(tt([o,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(o=tt([o,h.pathnameBase]))}return i}function zs(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=Hs(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:s.reduce((u,f,h)=>{let{paramName:p,isOptional:g}=f;if(p==="*"){let b=c[h]||"";i=o.slice(0,o.length-b.length).replace(/(.)\/+$/,"$1")}const N=c[h];return g&&!N?u[p]=void 0:u[p]=(N||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:i,pattern:e}}function Hs(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),nn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,c,d)=>(s.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),s]}function Ws(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return nn(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function On(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}const qs=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Js=e=>qs.test(e);function Ks(e,t){t===void 0&&(t="/");let{pathname:n,search:s="",hash:a=""}=typeof e=="string"?ut(e):e,o;if(n)if(Js(n))o=n;else{if(n.includes("//")){let i=n;n=n.replace(/\/\/+/g,"/"),nn(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+n))}n.startsWith("/")?o=Gn(n.substring(1),"/"):o=Gn(n,t)}else o=t;return{pathname:o,search:Vs(s),hash:Qs(a)}}function Gn(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function pn(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Xs(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function In(e,t){let n=Xs(e);return t?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Mn(e,t,n,s){s===void 0&&(s=!1);let a;typeof e=="string"?a=ut(e):(a=Dt({},e),le(!a.pathname||!a.pathname.includes("?"),pn("?","pathname","search",a)),le(!a.pathname||!a.pathname.includes("#"),pn("#","pathname","hash",a)),le(!a.search||!a.search.includes("#"),pn("#","search","hash",a)));let o=e===""||a.pathname==="",i=o?"/":a.pathname,c;if(i==null)c=n;else{let h=t.length-1;if(!s&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),h-=1;a.pathname=p.join("/")}c=h>=0?t[h]:"/"}let d=Ks(a,c),u=i&&i!=="/"&&i.endsWith("/"),f=(o||i===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(u||f)&&(d.pathname+="/"),d}const tt=e=>e.join("/").replace(/\/\/+/g,"/"),Ys=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Vs=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Qs=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Gs(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const kr=["post","put","patch","delete"];new Set(kr);const Zs=["get",...kr];new Set(Zs);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rt(){return Rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Rt.apply(this,arguments)}const Tn=l.createContext(null),ea=l.createContext(null),nt=l.createContext(null),rn=l.createContext(null),rt=l.createContext({outlet:null,matches:[],isDataRoute:!1}),Er=l.createContext(null);function ta(e,t){let{relative:n}=t===void 0?{}:t;gt()||le(!1);let{basename:s,navigator:a}=l.useContext(nt),{hash:o,pathname:i,search:c}=Rr(e,{relative:n}),d=i;return s!=="/"&&(d=i==="/"?s:tt([s,i])),a.createHref({pathname:d,search:c,hash:o})}function gt(){return l.useContext(rn)!=null}function Mt(){return gt()||le(!1),l.useContext(rn).location}function Dr(e){l.useContext(nt).static||l.useLayoutEffect(e)}function sn(){let{isDataRoute:e}=l.useContext(rt);return e?xa():na()}function na(){gt()||le(!1);let e=l.useContext(Tn),{basename:t,future:n,navigator:s}=l.useContext(nt),{matches:a}=l.useContext(rt),{pathname:o}=Mt(),i=JSON.stringify(In(a,n.v7_relativeSplatPath)),c=l.useRef(!1);return Dr(()=>{c.current=!0}),l.useCallback(function(u,f){if(f===void 0&&(f={}),!c.current)return;if(typeof u=="number"){s.go(u);return}let h=Mn(u,JSON.parse(i),o,f.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:tt([t,h.pathname])),(f.replace?s.replace:s.push)(h,f.state,f)},[t,s,i,o,e])}function Rr(e,t){let{relative:n}=t===void 0?{}:t,{future:s}=l.useContext(nt),{matches:a}=l.useContext(rt),{pathname:o}=Mt(),i=JSON.stringify(In(a,s.v7_relativeSplatPath));return l.useMemo(()=>Mn(e,JSON.parse(i),o,n==="path"),[e,i,o,n])}function ra(e,t){return sa(e,t)}function sa(e,t,n,s){gt()||le(!1);let{navigator:a}=l.useContext(nt),{matches:o}=l.useContext(rt),i=o[o.length-1],c=i?i.params:{};i&&i.pathname;let d=i?i.pathnameBase:"/";i&&i.route;let u=Mt(),f;if(t){var h;let m=typeof t=="string"?ut(t):t;d==="/"||(h=m.pathname)!=null&&h.startsWith(d)||le(!1),f=m}else f=u;let p=f.pathname||"/",g=p;if(d!=="/"){let m=d.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(m.length).join("/")}let N=Os(e,{pathname:g}),b=ca(N&&N.map(m=>Object.assign({},m,{params:Object.assign({},c,m.params),pathname:tt([d,a.encodeLocation?a.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?d:tt([d,a.encodeLocation?a.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),o,n,s);return t&&b?l.createElement(rn.Provider,{value:{location:Rt({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:et.Pop}},b):b}function aa(){let e=fa(),t=Gs(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return l.createElement(l.Fragment,null,l.createElement("h2",null,"Unexpected Application Error!"),l.createElement("h3",{style:{fontStyle:"italic"}},t),n?l.createElement("pre",{style:a},n):null,null)}const oa=l.createElement(aa,null);class la extends l.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?l.createElement(rt.Provider,{value:this.props.routeContext},l.createElement(Er.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ia(e){let{routeContext:t,match:n,children:s}=e,a=l.useContext(Tn);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),l.createElement(rt.Provider,{value:t},s)}function ca(e,t,n,s){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=s)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,c=(a=n)==null?void 0:a.errors;if(c!=null){let f=i.findIndex(h=>h.route.id&&(c==null?void 0:c[h.route.id])!==void 0);f>=0||le(!1),i=i.slice(0,Math.min(i.length,f+1))}let d=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let f=0;f<i.length;f++){let h=i[f];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=f),h.route.id){let{loaderData:p,errors:g}=n,N=h.route.loader&&p[h.route.id]===void 0&&(!g||g[h.route.id]===void 0);if(h.route.lazy||N){d=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((f,h,p)=>{let g,N=!1,b=null,m=null;n&&(g=c&&h.route.id?c[h.route.id]:void 0,b=h.route.errorElement||oa,d&&(u<0&&p===0?(pa("route-fallback"),N=!0,m=null):u===p&&(N=!0,m=h.route.hydrateFallbackElement||null)));let j=t.concat(i.slice(0,p+1)),S=()=>{let w;return g?w=b:N?w=m:h.route.Component?w=l.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=f,l.createElement(ia,{match:h,routeContext:{outlet:f,matches:j,isDataRoute:n!=null},children:w})};return n&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?l.createElement(la,{location:n.location,revalidation:n.revalidation,component:b,error:g,children:S(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):S()},null)}var Or=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Or||{}),Ir=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Ir||{});function da(e){let t=l.useContext(Tn);return t||le(!1),t}function ua(e){let t=l.useContext(ea);return t||le(!1),t}function ha(e){let t=l.useContext(rt);return t||le(!1),t}function Mr(e){let t=ha(),n=t.matches[t.matches.length-1];return n.route.id||le(!1),n.route.id}function fa(){var e;let t=l.useContext(Er),n=ua(),s=Mr();return t!==void 0?t:(e=n.errors)==null?void 0:e[s]}function xa(){let{router:e}=da(Or.UseNavigateStable),t=Mr(Ir.UseNavigateStable),n=l.useRef(!1);return Dr(()=>{n.current=!0}),l.useCallback(function(a,o){o===void 0&&(o={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Rt({fromRouteId:t},o)))},[e,t])}const Zn={};function pa(e,t,n){Zn[e]||(Zn[e]=!0)}function ma(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Ht(e){let{to:t,replace:n,state:s,relative:a}=e;gt()||le(!1);let{future:o,static:i}=l.useContext(nt),{matches:c}=l.useContext(rt),{pathname:d}=Mt(),u=sn(),f=Mn(t,In(c,o.v7_relativeSplatPath),d,a==="path"),h=JSON.stringify(f);return l.useEffect(()=>u(JSON.parse(h),{replace:n,state:s,relative:a}),[u,h,a,n,s]),null}function Ct(e){le(!1)}function ga(e){let{basename:t="/",children:n=null,location:s,navigationType:a=et.Pop,navigator:o,static:i=!1,future:c}=e;gt()&&le(!1);let d=t.replace(/^\/*/,"/"),u=l.useMemo(()=>({basename:d,navigator:o,static:i,future:Rt({v7_relativeSplatPath:!1},c)}),[d,c,o,i]);typeof s=="string"&&(s=ut(s));let{pathname:f="/",search:h="",hash:p="",state:g=null,key:N="default"}=s,b=l.useMemo(()=>{let m=On(f,d);return m==null?null:{location:{pathname:m,search:h,hash:p,state:g,key:N},navigationType:a}},[d,f,h,p,g,N,a]);return b==null?null:l.createElement(nt.Provider,{value:u},l.createElement(rn.Provider,{children:n,value:b}))}function ba(e){let{children:t,location:n}=e;return ra(Nn(t),n)}new Promise(()=>{});function Nn(e,t){t===void 0&&(t=[]);let n=[];return l.Children.forEach(e,(s,a)=>{if(!l.isValidElement(s))return;let o=[...t,a];if(s.type===l.Fragment){n.push.apply(n,Nn(s.props.children,o));return}s.type!==Ct&&le(!1),!s.props.index||!s.props.children||le(!1);let i={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=Nn(s.props.children,o)),n.push(i)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cn(){return Cn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Cn.apply(this,arguments)}function va(e,t){if(e==null)return{};var n={},s=Object.keys(e),a,o;for(o=0;o<s.length;o++)a=s[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function ya(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function wa(e,t){return e.button===0&&(!t||t==="_self")&&!ya(e)}const ja=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Na="6";try{window.__reactRouterVersion=Na}catch{}const Ca="startTransition",er=vs[Ca];function Sa(e){let{basename:t,children:n,future:s,window:a}=e,o=l.useRef();o.current==null&&(o.current=Es({window:a,v5Compat:!0}));let i=o.current,[c,d]=l.useState({action:i.action,location:i.location}),{v7_startTransition:u}=s||{},f=l.useCallback(h=>{u&&er?er(()=>d(h)):d(h)},[d,u]);return l.useLayoutEffect(()=>i.listen(f),[i,f]),l.useEffect(()=>ma(s),[s]),l.createElement(ga,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:i,future:s})}const ka=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ea=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tr=l.forwardRef(function(t,n){let{onClick:s,relative:a,reloadDocument:o,replace:i,state:c,target:d,to:u,preventScrollReset:f,viewTransition:h}=t,p=va(t,ja),{basename:g}=l.useContext(nt),N,b=!1;if(typeof u=="string"&&Ea.test(u)&&(N=u,ka))try{let w=new URL(window.location.href),D=u.startsWith("//")?new URL(w.protocol+u):new URL(u),M=On(D.pathname,g);D.origin===w.origin&&M!=null?u=M+D.search+D.hash:b=!0}catch{}let m=ta(u,{relative:a}),j=Da(u,{replace:i,state:c,target:d,preventScrollReset:f,relative:a,viewTransition:h});function S(w){s&&s(w),w.defaultPrevented||j(w)}return l.createElement("a",Cn({},p,{href:N||m,onClick:b||o?s:S,ref:n,target:d}))});var tr;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(tr||(tr={}));var nr;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(nr||(nr={}));function Da(e,t){let{target:n,replace:s,state:a,preventScrollReset:o,relative:i,viewTransition:c}=t===void 0?{}:t,d=sn(),u=Mt(),f=Rr(e,{relative:i});return l.useCallback(h=>{if(wa(h,n)){h.preventDefault();let p=s!==void 0?s:Yt(u)===Yt(f);d(e,{replace:p,state:a,preventScrollReset:o,relative:i,viewTransition:c})}},[u,d,f,s,a,n,e,o,i,c])}function Ra(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const an=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function bt(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function _n(e){return"nodeType"in e}function ve(e){var t,n;return e?bt(e)?e:_n(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function An(e){const{Document:t}=ve(e);return e instanceof t}function Tt(e){return bt(e)?!1:e instanceof ve(e).HTMLElement}function _r(e){return e instanceof ve(e).SVGElement}function vt(e){return e?bt(e)?e.document:_n(e)?An(e)?e:Tt(e)||_r(e)?e.ownerDocument:document:document:document}const Be=an?l.useLayoutEffect:l.useEffect;function on(e){const t=l.useRef(e);return Be(()=>{t.current=e}),l.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function Oa(){const e=l.useRef(null),t=l.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ot(e,t){t===void 0&&(t=[e]);const n=l.useRef(e);return Be(()=>{n.current!==e&&(n.current=e)},t),n}function _t(e,t){const n=l.useRef();return l.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function Vt(e){const t=on(e),n=l.useRef(null),s=l.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,s]}function Qt(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let mn={};function At(e,t){return l.useMemo(()=>{if(t)return t;const n=mn[e]==null?0:mn[e]+1;return mn[e]=n,e+"-"+n},[e,t])}function Ar(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((o,i)=>{const c=Object.entries(i);for(const[d,u]of c){const f=o[d];f!=null&&(o[d]=f+e*u)}return o},{...t})}}const mt=Ar(1),Gt=Ar(-1);function Ia(e){return"clientX"in e&&"clientY"in e}function ln(e){if(!e)return!1;const{KeyboardEvent:t}=ve(e.target);return t&&e instanceof t}function Ma(e){if(!e)return!1;const{TouchEvent:t}=ve(e.target);return t&&e instanceof t}function Zt(e){if(Ma(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Ia(e)?{x:e.clientX,y:e.clientY}:null}const Xe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Xe.Translate.toString(e),Xe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),rr="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ta(e){return e.matches(rr)?e:e.querySelector(rr)}const _a={display:"none"};function Aa(e){let{id:t,value:n}=e;return V.createElement("div",{id:t,style:_a},n)}function La(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return V.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function Pa(){const[e,t]=l.useState("");return{announce:l.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const Lr=l.createContext(null);function Ba(e){const t=l.useContext(Lr);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function $a(){const[e]=l.useState(()=>new Set),t=l.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[l.useCallback(s=>{let{type:a,event:o}=s;e.forEach(i=>{var c;return(c=i[a])==null?void 0:c.call(i,o)})},[e]),t]}const Ua={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Fa={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function za(e){let{announcements:t=Fa,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=Ua}=e;const{announce:o,announcement:i}=Pa(),c=At("DndLiveRegion"),[d,u]=l.useState(!1);if(l.useEffect(()=>{u(!0)},[]),Ba(l.useMemo(()=>({onDragStart(h){let{active:p}=h;o(t.onDragStart({active:p}))},onDragMove(h){let{active:p,over:g}=h;t.onDragMove&&o(t.onDragMove({active:p,over:g}))},onDragOver(h){let{active:p,over:g}=h;o(t.onDragOver({active:p,over:g}))},onDragEnd(h){let{active:p,over:g}=h;o(t.onDragEnd({active:p,over:g}))},onDragCancel(h){let{active:p,over:g}=h;o(t.onDragCancel({active:p,over:g}))}}),[o,t])),!d)return null;const f=V.createElement(V.Fragment,null,V.createElement(Aa,{id:s,value:a.draggable}),V.createElement(La,{id:c,announcement:i}));return n?pt.createPortal(f,n):f}var ue;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ue||(ue={}));function en(){}function Pr(e,t){return l.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Br(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const $e=Object.freeze({x:0,y:0});function Ha(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Wa(e,t){const n=Zt(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function qa(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function Ja(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function Ka(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function sr(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const $r=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=sr(t,t.left,t.top),o=[];for(const i of s){const{id:c}=i,d=n.get(c);if(d){const u=Ha(sr(d),a);o.push({id:c,data:{droppableContainer:i,value:u}})}}return o.sort(qa)};function Xa(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),i=a-s,c=o-n;if(s<a&&n<o){const d=t.width*t.height,u=e.width*e.height,f=i*c,h=f/(d+u-f);return Number(h.toFixed(4))}return 0}const Ya=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const o of s){const{id:i}=o,c=n.get(i);if(c){const d=Xa(c,t);d>0&&a.push({id:i,data:{droppableContainer:o,value:d}})}}return a.sort(Ja)};function Va(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Ur(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:$e}function Qa(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),o=1;o<s;o++)a[o-1]=arguments[o];return a.reduce((i,c)=>({...i,top:i.top+e*c.y,bottom:i.bottom+e*c.y,left:i.left+e*c.x,right:i.right+e*c.x}),{...n})}}const Ga=Qa(1);function Fr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Za(e,t,n){const s=Fr(t);if(!s)return e;const{scaleX:a,scaleY:o,x:i,y:c}=s,d=e.left-i-(1-a)*parseFloat(n),u=e.top-c-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),f=a?e.width/a:e.width,h=o?e.height/o:e.height;return{width:f,height:h,top:u,right:d+f,bottom:u+h,left:d}}const eo={ignoreTransform:!1};function yt(e,t){t===void 0&&(t=eo);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:f}=ve(e).getComputedStyle(e);u&&(n=Za(n,u,f))}const{top:s,left:a,width:o,height:i,bottom:c,right:d}=n;return{top:s,left:a,width:o,height:i,bottom:c,right:d}}function ar(e){return yt(e,{ignoreTransform:!0})}function to(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function no(e,t){return t===void 0&&(t=ve(e).getComputedStyle(e)),t.position==="fixed"}function ro(e,t){t===void 0&&(t=ve(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=t[a];return typeof o=="string"?n.test(o):!1})}function Ln(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(An(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!Tt(a)||_r(a)||n.includes(a))return n;const o=ve(e).getComputedStyle(a);return a!==e&&ro(a,o)&&n.push(a),no(a,o)?n:s(a.parentNode)}return e?s(e):n}function zr(e){const[t]=Ln(e,1);return t??null}function gn(e){return!an||!e?null:bt(e)?e:_n(e)?An(e)||e===vt(e).scrollingElement?window:Tt(e)?e:null:null}function Hr(e){return bt(e)?e.scrollX:e.scrollLeft}function Wr(e){return bt(e)?e.scrollY:e.scrollTop}function Sn(e){return{x:Hr(e),y:Wr(e)}}var pe;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(pe||(pe={}));function qr(e){return!an||!e?!1:e===document.scrollingElement}function Jr(e){const t={x:0,y:0},n=qr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,i=e.scrollTop>=s.y,c=e.scrollLeft>=s.x;return{isTop:a,isLeft:o,isBottom:i,isRight:c,maxScroll:s,minScroll:t}}const so={x:.2,y:.2};function ao(e,t,n,s,a){let{top:o,left:i,right:c,bottom:d}=n;s===void 0&&(s=10),a===void 0&&(a=so);const{isTop:u,isBottom:f,isLeft:h,isRight:p}=Jr(e),g={x:0,y:0},N={x:0,y:0},b={height:t.height*a.y,width:t.width*a.x};return!u&&o<=t.top+b.height?(g.y=pe.Backward,N.y=s*Math.abs((t.top+b.height-o)/b.height)):!f&&d>=t.bottom-b.height&&(g.y=pe.Forward,N.y=s*Math.abs((t.bottom-b.height-d)/b.height)),!p&&c>=t.right-b.width?(g.x=pe.Forward,N.x=s*Math.abs((t.right-b.width-c)/b.width)):!h&&i<=t.left+b.width&&(g.x=pe.Backward,N.x=s*Math.abs((t.left+b.width-i)/b.width)),{direction:g,speed:N}}function oo(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:i}=window;return{top:0,left:0,right:o,bottom:i,width:o,height:i}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function Kr(e){return e.reduce((t,n)=>mt(t,Sn(n)),$e)}function lo(e){return e.reduce((t,n)=>t+Hr(n),0)}function io(e){return e.reduce((t,n)=>t+Wr(n),0)}function Xr(e,t){if(t===void 0&&(t=yt),!e)return;const{top:n,left:s,bottom:a,right:o}=t(e);zr(e)&&(a<=0||o<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const co=[["x",["left","right"],lo],["y",["top","bottom"],io]];class Pn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Ln(n),a=Kr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,i,c]of co)for(const d of i)Object.defineProperty(this,d,{get:()=>{const u=c(s),f=a[o]-u;return this.rect[d]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class St{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function uo(e){const{EventTarget:t}=ve(e);return e instanceof t?e:vt(e)}function bn(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var Re;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Re||(Re={}));function or(e){e.preventDefault()}function ho(e){e.stopPropagation()}var X;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(X||(X={}));const Yr={start:[X.Space,X.Enter],cancel:[X.Esc],end:[X.Space,X.Enter,X.Tab]},fo=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case X.Right:return{...n,x:n.x+25};case X.Left:return{...n,x:n.x-25};case X.Down:return{...n,y:n.y+25};case X.Up:return{...n,y:n.y-25}}};class Vr{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new St(vt(n)),this.windowListeners=new St(ve(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Re.Resize,this.handleCancel),this.windowListeners.add(Re.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Re.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&Xr(s),n($e)}handleKeyDown(t){if(ln(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:o=Yr,coordinateGetter:i=fo,scrollBehavior:c="smooth"}=a,{code:d}=t;if(o.end.includes(d)){this.handleEnd(t);return}if(o.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:u}=s.current,f=u?{x:u.left,y:u.top}:$e;this.referenceCoordinates||(this.referenceCoordinates=f);const h=i(t,{active:n,context:s.current,currentCoordinates:f});if(h){const p=Gt(h,f),g={x:0,y:0},{scrollableAncestors:N}=s.current;for(const b of N){const m=t.code,{isTop:j,isRight:S,isLeft:w,isBottom:D,maxScroll:M,minScroll:R}=Jr(b),O=oo(b),y={x:Math.min(m===X.Right?O.right-O.width/2:O.right,Math.max(m===X.Right?O.left:O.left+O.width/2,h.x)),y:Math.min(m===X.Down?O.bottom-O.height/2:O.bottom,Math.max(m===X.Down?O.top:O.top+O.height/2,h.y))},k=m===X.Right&&!S||m===X.Left&&!w,T=m===X.Down&&!D||m===X.Up&&!j;if(k&&y.x!==h.x){const A=b.scrollLeft+p.x,Y=m===X.Right&&A<=M.x||m===X.Left&&A>=R.x;if(Y&&!p.y){b.scrollTo({left:A,behavior:c});return}Y?g.x=b.scrollLeft-A:g.x=m===X.Right?b.scrollLeft-M.x:b.scrollLeft-R.x,g.x&&b.scrollBy({left:-g.x,behavior:c});break}else if(T&&y.y!==h.y){const A=b.scrollTop+p.y,Y=m===X.Down&&A<=M.y||m===X.Up&&A>=R.y;if(Y&&!p.x){b.scrollTo({top:A,behavior:c});return}Y?g.y=b.scrollTop-A:g.y=m===X.Down?b.scrollTop-M.y:b.scrollTop-R.y,g.y&&b.scrollBy({top:-g.y,behavior:c});break}}this.handleMove(t,mt(Gt(h,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Vr.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=Yr,onActivation:a}=t,{active:o}=n;const{code:i}=e.nativeEvent;if(s.start.includes(i)){const c=o.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function lr(e){return!!(e&&"distance"in e)}function ir(e){return!!(e&&"delay"in e)}class Bn{constructor(t,n,s){var a;s===void 0&&(s=uo(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:i}=o;this.props=t,this.events=n,this.document=vt(i),this.documentListeners=new St(this.document),this.listeners=new St(s),this.windowListeners=new St(ve(i)),this.initialCoordinates=(a=Zt(o))!=null?a:$e,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Re.Resize,this.handleCancel),this.windowListeners.add(Re.DragStart,or),this.windowListeners.add(Re.VisibilityChange,this.handleCancel),this.windowListeners.add(Re.ContextMenu,or),this.documentListeners.add(Re.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ir(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(lr(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Re.Click,ho,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Re.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:o}=this,{onMove:i,options:{activationConstraint:c}}=o;if(!a)return;const d=(n=Zt(t))!=null?n:$e,u=Gt(a,d);if(!s&&c){if(lr(c)){if(c.tolerance!=null&&bn(u,c.tolerance))return this.handleCancel();if(bn(u,c.distance))return this.handleStart()}if(ir(c)&&bn(u,c.tolerance))return this.handleCancel();this.handlePending(c,u);return}t.cancelable&&t.preventDefault(),i(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===X.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const xo={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class cn extends Bn{constructor(t){const{event:n}=t,s=vt(n.target);super(t,xo,s)}}cn.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const po={move:{name:"mousemove"},end:{name:"mouseup"}};var kn;(function(e){e[e.RightClick=2]="RightClick"})(kn||(kn={}));class mo extends Bn{constructor(t){super(t,po,vt(t.event.target))}}mo.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===kn.RightClick?!1:(s==null||s({event:n}),!0)}}];const vn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class go extends Bn{constructor(t){super(t,vn)}static setup(){return window.addEventListener(vn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(vn.move.name,t)};function t(){}}}go.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s==null||s({event:n}),!0)}}];var kt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(kt||(kt={}));var tn;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(tn||(tn={}));function bo(e){let{acceleration:t,activator:n=kt.Pointer,canScroll:s,draggingRect:a,enabled:o,interval:i=5,order:c=tn.TreeOrder,pointerCoordinates:d,scrollableAncestors:u,scrollableAncestorRects:f,delta:h,threshold:p}=e;const g=yo({delta:h,disabled:!o}),[N,b]=Oa(),m=l.useRef({x:0,y:0}),j=l.useRef({x:0,y:0}),S=l.useMemo(()=>{switch(n){case kt.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case kt.DraggableRect:return a}},[n,a,d]),w=l.useRef(null),D=l.useCallback(()=>{const R=w.current;if(!R)return;const O=m.current.x*j.current.x,y=m.current.y*j.current.y;R.scrollBy(O,y)},[]),M=l.useMemo(()=>c===tn.TreeOrder?[...u].reverse():u,[c,u]);l.useEffect(()=>{if(!o||!u.length||!S){b();return}for(const R of M){if((s==null?void 0:s(R))===!1)continue;const O=u.indexOf(R),y=f[O];if(!y)continue;const{direction:k,speed:T}=ao(R,y,S,t,p);for(const A of["x","y"])g[A][k[A]]||(T[A]=0,k[A]=0);if(T.x>0||T.y>0){b(),w.current=R,N(D,i),m.current=T,j.current=k;return}}m.current={x:0,y:0},j.current={x:0,y:0},b()},[t,D,s,b,o,i,JSON.stringify(S),JSON.stringify(g),N,u,M,f,JSON.stringify(p)])}const vo={x:{[pe.Backward]:!1,[pe.Forward]:!1},y:{[pe.Backward]:!1,[pe.Forward]:!1}};function yo(e){let{delta:t,disabled:n}=e;const s=Qt(t);return _t(a=>{if(n||!s||!a)return vo;const o={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[pe.Backward]:a.x[pe.Backward]||o.x===-1,[pe.Forward]:a.x[pe.Forward]||o.x===1},y:{[pe.Backward]:a.y[pe.Backward]||o.y===-1,[pe.Forward]:a.y[pe.Forward]||o.y===1}}},[n,t,s])}function wo(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return _t(a=>{var o;return t==null?null:(o=s??a)!=null?o:null},[s,t])}function jo(e,t){return l.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,o=a.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,s)}));return[...n,...o]},[]),[e,t])}var It;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(It||(It={}));var En;(function(e){e.Optimized="optimized"})(En||(En={}));const cr=new Map;function No(e,t){let{dragging:n,dependencies:s,config:a}=t;const[o,i]=l.useState(null),{frequency:c,measure:d,strategy:u}=a,f=l.useRef(e),h=m(),p=Ot(h),g=l.useCallback(function(j){j===void 0&&(j=[]),!p.current&&i(S=>S===null?j:S.concat(j.filter(w=>!S.includes(w))))},[p]),N=l.useRef(null),b=_t(j=>{if(h&&!n)return cr;if(!j||j===cr||f.current!==e||o!=null){const S=new Map;for(let w of e){if(!w)continue;if(o&&o.length>0&&!o.includes(w.id)&&w.rect.current){S.set(w.id,w.rect.current);continue}const D=w.node.current,M=D?new Pn(d(D),D):null;w.rect.current=M,M&&S.set(w.id,M)}return S}return j},[e,o,n,h,d]);return l.useEffect(()=>{f.current=e},[e]),l.useEffect(()=>{h||g()},[n,h]),l.useEffect(()=>{o&&o.length>0&&i(null)},[JSON.stringify(o)]),l.useEffect(()=>{h||typeof c!="number"||N.current!==null||(N.current=setTimeout(()=>{g(),N.current=null},c))},[c,h,g,...s]),{droppableRects:b,measureDroppableContainers:g,measuringScheduled:o!=null};function m(){switch(u){case It.Always:return!1;case It.BeforeDragging:return n;default:return!n}}}function $n(e,t){return _t(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Co(e,t){return $n(e,t)}function So(e){let{callback:t,disabled:n}=e;const s=on(t),a=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(s)},[s,n]);return l.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function dn(e){let{callback:t,disabled:n}=e;const s=on(t),a=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(s)},[n]);return l.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function ko(e){return new Pn(yt(e),e)}function dr(e,t,n){t===void 0&&(t=ko);const[s,a]=l.useState(null);function o(){a(d=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=d??n)!=null?u:null}const f=t(e);return JSON.stringify(d)===JSON.stringify(f)?d:f})}const i=So({callback(d){if(e)for(const u of d){const{type:f,target:h}=u;if(f==="childList"&&h instanceof HTMLElement&&h.contains(e)){o();break}}}}),c=dn({callback:o});return Be(()=>{o(),e?(c==null||c.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),i==null||i.disconnect())},[e]),s}function Eo(e){const t=$n(e);return Ur(e,t)}const ur=[];function Do(e){const t=l.useRef(e),n=_t(s=>e?s&&s!==ur&&e&&t.current&&e.parentNode===t.current.parentNode?s:Ln(e):ur,[e]);return l.useEffect(()=>{t.current=e},[e]),n}function Ro(e){const[t,n]=l.useState(null),s=l.useRef(e),a=l.useCallback(o=>{const i=gn(o.target);i&&n(c=>c?(c.set(i,Sn(i)),new Map(c)):null)},[]);return l.useEffect(()=>{const o=s.current;if(e!==o){i(o);const c=e.map(d=>{const u=gn(d);return u?(u.addEventListener("scroll",a,{passive:!0}),[u,Sn(u)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),s.current=e}return()=>{i(e),i(o)};function i(c){c.forEach(d=>{const u=gn(d);u==null||u.removeEventListener("scroll",a)})}},[a,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,i)=>mt(o,i),$e):Kr(e):$e,[e,t])}function hr(e,t){t===void 0&&(t=[]);const n=l.useRef(null);return l.useEffect(()=>{n.current=null},t),l.useEffect(()=>{const s=e!==$e;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Gt(e,n.current):$e}function Oo(e){l.useEffect(()=>{if(!an)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Io(e,t){return l.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:o}=s;return n[a]=i=>{o(i,t)},n},{}),[e,t])}function Qr(e){return l.useMemo(()=>e?to(e):null,[e])}const fr=[];function Mo(e,t){t===void 0&&(t=yt);const[n]=e,s=Qr(n?ve(n):null),[a,o]=l.useState(fr);function i(){o(()=>e.length?e.map(d=>qr(d)?s:new Pn(t(d),d)):fr)}const c=dn({callback:i});return Be(()=>{c==null||c.disconnect(),i(),e.forEach(d=>c==null?void 0:c.observe(d))},[e]),a}function Gr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Tt(t)?t:e}function To(e){let{measure:t}=e;const[n,s]=l.useState(null),a=l.useCallback(u=>{for(const{target:f}of u)if(Tt(f)){s(h=>{const p=t(f);return h?{...h,width:p.width,height:p.height}:p});break}},[t]),o=dn({callback:a}),i=l.useCallback(u=>{const f=Gr(u);o==null||o.disconnect(),f&&(o==null||o.observe(f)),s(f?t(f):null)},[t,o]),[c,d]=Vt(i);return l.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const _o=[{sensor:cn,options:{}},{sensor:Vr,options:{}}],Ao={current:{}},Kt={draggable:{measure:ar},droppable:{measure:ar,strategy:It.WhileDragging,frequency:En.Optimized},dragOverlay:{measure:yt}};class Et extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const Lo={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Et,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:en},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Kt,measureDroppableContainers:en,windowRect:null,measuringScheduled:!1},Zr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:en,draggableNodes:new Map,over:null,measureDroppableContainers:en},Lt=l.createContext(Zr),es=l.createContext(Lo);function Po(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Et}}}function Bo(e,t){switch(t.type){case ue.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ue.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ue.DragEnd:case ue.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ue.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new Et(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case ue.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,o=e.droppable.containers.get(n);if(!o||s!==o.key)return e;const i=new Et(e.droppable.containers);return i.set(n,{...o,disabled:a}),{...e,droppable:{...e.droppable,containers:i}}}case ue.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const o=new Et(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function $o(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=l.useContext(Lt),o=Qt(s),i=Qt(n==null?void 0:n.id);return l.useEffect(()=>{if(!t&&!s&&o&&i!=null){if(!ln(o)||document.activeElement===o.target)return;const c=a.get(i);if(!c)return;const{activatorNode:d,node:u}=c;if(!d.current&&!u.current)return;requestAnimationFrame(()=>{for(const f of[d.current,u.current]){if(!f)continue;const h=Ta(f);if(h){h.focus();break}}})}},[s,t,a,i,o]),null}function ts(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,o)=>o({transform:a,...s}),n):n}function Uo(e){return l.useMemo(()=>({draggable:{...Kt.draggable,...e==null?void 0:e.draggable},droppable:{...Kt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Kt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Fo(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const o=l.useRef(!1),{x:i,y:c}=typeof a=="boolean"?{x:a,y:a}:a;Be(()=>{if(!i&&!c||!t){o.current=!1;return}if(o.current||!s)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const f=n(u),h=Ur(f,s);if(i||(h.x=0),c||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const p=zr(u);p&&p.scrollBy({top:h.y,left:h.x})}},[t,i,c,s,n])}const un=l.createContext({...$e,scaleX:1,scaleY:1});var Ze;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ze||(Ze={}));const ns=l.memo(function(t){var n,s,a,o;let{id:i,accessibility:c,autoScroll:d=!0,children:u,sensors:f=_o,collisionDetection:h=Ya,measuring:p,modifiers:g,...N}=t;const b=l.useReducer(Bo,void 0,Po),[m,j]=b,[S,w]=$a(),[D,M]=l.useState(Ze.Uninitialized),R=D===Ze.Initialized,{draggable:{active:O,nodes:y,translate:k},droppable:{containers:T}}=m,A=O!=null?y.get(O):null,Y=l.useRef({initial:null,translated:null}),F=l.useMemo(()=>{var fe;return O!=null?{id:O,data:(fe=A==null?void 0:A.data)!=null?fe:Ao,rect:Y}:null},[O,A]),z=l.useRef(null),[L,B]=l.useState(null),[_,he]=l.useState(null),re=Ot(N,Object.values(N)),H=At("DndDescribedBy",i),ye=l.useMemo(()=>T.getEnabled(),[T]),G=Uo(p),{droppableRects:Q,measureDroppableContainers:ne,measuringScheduled:P}=No(ye,{dragging:R,dependencies:[k.x,k.y],config:G.droppable}),q=wo(y,O),ie=l.useMemo(()=>_?Zt(_):null,[_]),ee=zt(),$=Co(q,G.draggable.measure);Fo({activeNode:O!=null?y.get(O):null,config:ee.layoutShiftCompensation,initialRect:$,measure:G.draggable.measure});const I=dr(q,G.draggable.measure,$),te=dr(q?q.parentElement:null),Z=l.useRef({activatorEvent:null,active:null,activeNode:q,collisionRect:null,collisions:null,droppableRects:Q,draggableNodes:y,draggingNode:null,draggingNodeRect:null,droppableContainers:T,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),oe=T.getNodeFor((n=Z.current.over)==null?void 0:n.id),W=To({measure:G.dragOverlay.measure}),Ye=(s=W.nodeRef.current)!=null?s:q,Ce=R?(a=W.rect)!=null?a:I:null,Pt=!!(W.nodeRef.current&&W.rect),Ve=Eo(Pt?null:I),wt=Qr(Ye?ve(Ye):null),Se=Do(R?oe??q:null),qe=Mo(Se),Je=ts(g,{transform:{x:k.x-Ve.x,y:k.y-Ve.y,scaleX:1,scaleY:1},activatorEvent:_,active:F,activeNodeRect:I,containerNodeRect:te,draggingNodeRect:Ce,over:Z.current.over,overlayNodeRect:W.rect,scrollableAncestors:Se,scrollableAncestorRects:qe,windowRect:wt}),st=ie?mt(ie,k):null,Ue=Ro(Se),Bt=hr(Ue),at=hr(Ue,[I]),Oe=mt(Je,Bt),ke=Ce?Ga(Ce,Je):null,Fe=F&&ke?h({active:F,collisionRect:ke,droppableRects:Q,droppableContainers:ye,pointerCoordinates:st}):null,jt=Ka(Fe,"id"),[we,Ie]=l.useState(null),ot=Pt?Je:mt(Je,at),ze=Va(ot,(o=we==null?void 0:we.rect)!=null?o:null,I),lt=l.useRef(null),Nt=l.useCallback((fe,ge)=>{let{sensor:se,options:me}=ge;if(z.current==null)return;const je=y.get(z.current);if(!je)return;const xe=fe.nativeEvent,Ee=new se({active:z.current,activeNode:je,event:xe,options:me,context:Z,onAbort(ce){if(!y.get(ce))return;const{onDragAbort:De}=re.current,Me={id:ce};De==null||De(Me),S({type:"onDragAbort",event:Me})},onPending(ce,He,De,Me){if(!y.get(ce))return;const{onDragPending:Ge}=re.current,Te={id:ce,constraint:He,initialCoordinates:De,offset:Me};Ge==null||Ge(Te),S({type:"onDragPending",event:Te})},onStart(ce){const He=z.current;if(He==null)return;const De=y.get(He);if(!De)return;const{onDragStart:Me}=re.current,it={activatorEvent:xe,active:{id:He,data:De.data,rect:Y}};pt.unstable_batchedUpdates(()=>{Me==null||Me(it),M(Ze.Initializing),j({type:ue.DragStart,initialCoordinates:ce,active:He}),S({type:"onDragStart",event:it}),B(lt.current),he(xe)})},onMove(ce){j({type:ue.DragMove,coordinates:ce})},onEnd:Qe(ue.DragEnd),onCancel:Qe(ue.DragCancel)});lt.current=Ee;function Qe(ce){return async function(){const{active:De,collisions:Me,over:it,scrollAdjustedTranslate:Ge}=Z.current;let Te=null;if(De&&Ge){const{cancelDrop:ct}=re.current;Te={activatorEvent:xe,active:De,collisions:Me,delta:Ge,over:it},ce===ue.DragEnd&&typeof ct=="function"&&await Promise.resolve(ct(Te))&&(ce=ue.DragCancel)}z.current=null,pt.unstable_batchedUpdates(()=>{j({type:ce}),M(Ze.Uninitialized),Ie(null),B(null),he(null),lt.current=null;const ct=ce===ue.DragEnd?"onDragEnd":"onDragCancel";if(Te){const ht=re.current[ct];ht==null||ht(Te),S({type:ct,event:Te})}})}}},[y]),$t=l.useCallback((fe,ge)=>(se,me)=>{const je=se.nativeEvent,xe=y.get(me);if(z.current!==null||!xe||je.dndKit||je.defaultPrevented)return;const Ee={active:xe};fe(se,ge.options,Ee)===!0&&(je.dndKit={capturedBy:ge.sensor},z.current=me,Nt(se,ge))},[y,Nt]),Ut=jo(f,$t);Oo(f),Be(()=>{I&&D===Ze.Initializing&&M(Ze.Initialized)},[I,D]),l.useEffect(()=>{const{onDragMove:fe}=re.current,{active:ge,activatorEvent:se,collisions:me,over:je}=Z.current;if(!ge||!se)return;const xe={active:ge,activatorEvent:se,collisions:me,delta:{x:Oe.x,y:Oe.y},over:je};pt.unstable_batchedUpdates(()=>{fe==null||fe(xe),S({type:"onDragMove",event:xe})})},[Oe.x,Oe.y]),l.useEffect(()=>{const{active:fe,activatorEvent:ge,collisions:se,droppableContainers:me,scrollAdjustedTranslate:je}=Z.current;if(!fe||z.current==null||!ge||!je)return;const{onDragOver:xe}=re.current,Ee=me.get(jt),Qe=Ee&&Ee.rect.current?{id:Ee.id,rect:Ee.rect.current,data:Ee.data,disabled:Ee.disabled}:null,ce={active:fe,activatorEvent:ge,collisions:se,delta:{x:je.x,y:je.y},over:Qe};pt.unstable_batchedUpdates(()=>{Ie(Qe),xe==null||xe(ce),S({type:"onDragOver",event:ce})})},[jt]),Be(()=>{Z.current={activatorEvent:_,active:F,activeNode:q,collisionRect:ke,collisions:Fe,droppableRects:Q,draggableNodes:y,draggingNode:Ye,draggingNodeRect:Ce,droppableContainers:T,over:we,scrollableAncestors:Se,scrollAdjustedTranslate:Oe},Y.current={initial:Ce,translated:ke}},[F,q,Fe,ke,y,Ye,Ce,Q,T,we,Se,Oe]),bo({...ee,delta:k,draggingRect:ke,pointerCoordinates:st,scrollableAncestors:Se,scrollableAncestorRects:qe});const fn=l.useMemo(()=>({active:F,activeNode:q,activeNodeRect:I,activatorEvent:_,collisions:Fe,containerNodeRect:te,dragOverlay:W,draggableNodes:y,droppableContainers:T,droppableRects:Q,over:we,measureDroppableContainers:ne,scrollableAncestors:Se,scrollableAncestorRects:qe,measuringConfiguration:G,measuringScheduled:P,windowRect:wt}),[F,q,I,_,Fe,te,W,y,T,Q,we,ne,Se,qe,G,P,wt]),Ft=l.useMemo(()=>({activatorEvent:_,activators:Ut,active:F,activeNodeRect:I,ariaDescribedById:{draggable:H},dispatch:j,draggableNodes:y,over:we,measureDroppableContainers:ne}),[_,Ut,F,I,j,H,y,we,ne]);return V.createElement(Lr.Provider,{value:w},V.createElement(Lt.Provider,{value:Ft},V.createElement(es.Provider,{value:fn},V.createElement(un.Provider,{value:ze},u)),V.createElement($o,{disabled:(c==null?void 0:c.restoreFocus)===!1})),V.createElement(za,{...c,hiddenTextDescribedById:H}));function zt(){const fe=(L==null?void 0:L.autoScrollEnabled)===!1,ge=typeof d=="object"?d.enabled===!1:d===!1,se=R&&!fe&&!ge;return typeof d=="object"?{...d,enabled:se}:{enabled:se}}}),zo=l.createContext(null),xr="button",Ho="Draggable";function Wo(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const o=At(Ho),{activators:i,activatorEvent:c,active:d,activeNodeRect:u,ariaDescribedById:f,draggableNodes:h,over:p}=l.useContext(Lt),{role:g=xr,roleDescription:N="draggable",tabIndex:b=0}=a??{},m=(d==null?void 0:d.id)===t,j=l.useContext(m?un:zo),[S,w]=Vt(),[D,M]=Vt(),R=Io(i,t),O=Ot(n);Be(()=>(h.set(t,{id:t,key:o,node:S,activatorNode:D,data:O}),()=>{const k=h.get(t);k&&k.key===o&&h.delete(t)}),[h,t]);const y=l.useMemo(()=>({role:g,tabIndex:b,"aria-disabled":s,"aria-pressed":m&&g===xr?!0:void 0,"aria-roledescription":N,"aria-describedby":f.draggable}),[s,g,b,m,N,f.draggable]);return{active:d,activatorEvent:c,activeNodeRect:u,attributes:y,isDragging:m,listeners:s?void 0:R,node:S,over:p,setNodeRef:w,setActivatorNodeRef:M,transform:j}}function rs(){return l.useContext(es)}const qo="Droppable",Jo={timeout:25};function Ko(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const o=At(qo),{active:i,dispatch:c,over:d,measureDroppableContainers:u}=l.useContext(Lt),f=l.useRef({disabled:n}),h=l.useRef(!1),p=l.useRef(null),g=l.useRef(null),{disabled:N,updateMeasurementsFor:b,timeout:m}={...Jo,...a},j=Ot(b??s),S=l.useCallback(()=>{if(!h.current){h.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(j.current)?j.current:[j.current]),g.current=null},m)},[m]),w=dn({callback:S,disabled:N||!i}),D=l.useCallback((y,k)=>{w&&(k&&(w.unobserve(k),h.current=!1),y&&w.observe(y))},[w]),[M,R]=Vt(D),O=Ot(t);return l.useEffect(()=>{!w||!M.current||(w.disconnect(),h.current=!1,w.observe(M.current))},[M,w]),l.useEffect(()=>(c({type:ue.RegisterDroppable,element:{id:s,key:o,disabled:n,node:M,rect:p,data:O}}),()=>c({type:ue.UnregisterDroppable,key:o,id:s})),[s]),l.useEffect(()=>{n!==f.current.disabled&&(c({type:ue.SetDroppableDisabled,id:s,key:o,disabled:n}),f.current.disabled=n)},[s,o,n,c]),{active:i,rect:p,isOver:(d==null?void 0:d.id)===s,node:M,over:d,setNodeRef:R}}function Xo(e){let{animation:t,children:n}=e;const[s,a]=l.useState(null),[o,i]=l.useState(null),c=Qt(n);return!n&&!s&&c&&a(c),Be(()=>{if(!o)return;const d=s==null?void 0:s.key,u=s==null?void 0:s.props.id;if(d==null||u==null){a(null);return}Promise.resolve(t(u,o)).then(()=>{a(null)})},[t,s,o]),V.createElement(V.Fragment,null,n,s?l.cloneElement(s,{ref:i}):null)}const Yo={x:0,y:0,scaleX:1,scaleY:1};function Vo(e){let{children:t}=e;return V.createElement(Lt.Provider,{value:Zr},V.createElement(un.Provider,{value:Yo},t))}const Qo={position:"fixed",touchAction:"none"},Go=e=>ln(e)?"transform 250ms ease":void 0,Zo=l.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:o,className:i,rect:c,style:d,transform:u,transition:f=Go}=e;if(!c)return null;const h=a?u:{...u,scaleX:1,scaleY:1},p={...Qo,width:c.width,height:c.height,top:c.top,left:c.left,transform:Xe.Transform.toString(h),transformOrigin:a&&s?Wa(s,c):void 0,transition:typeof f=="function"?f(s):f,...d};return V.createElement(n,{className:i,style:p,ref:t},o)}),el=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:o,className:i}=e;if(o!=null&&o.active)for(const[c,d]of Object.entries(o.active))d!==void 0&&(a[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,d));if(o!=null&&o.dragOverlay)for(const[c,d]of Object.entries(o.dragOverlay))d!==void 0&&s.node.style.setProperty(c,d);return i!=null&&i.active&&n.node.classList.add(i.active),i!=null&&i.dragOverlay&&s.node.classList.add(i.dragOverlay),function(){for(const[d,u]of Object.entries(a))n.node.style.setProperty(d,u);i!=null&&i.active&&n.node.classList.remove(i.active)}},tl=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Xe.Transform.toString(t)},{transform:Xe.Transform.toString(n)}]},nl={duration:250,easing:"ease",keyframes:tl,sideEffects:el({styles:{active:{opacity:"0"}}})};function rl(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return on((o,i)=>{if(t===null)return;const c=n.get(o);if(!c)return;const d=c.node.current;if(!d)return;const u=Gr(i);if(!u)return;const{transform:f}=ve(i).getComputedStyle(i),h=Fr(f);if(!h)return;const p=typeof t=="function"?t:sl(t);return Xr(d,a.draggable.measure),p({active:{id:o,data:c.data,node:d,rect:a.draggable.measure(d)},draggableNodes:n,dragOverlay:{node:i,rect:a.dragOverlay.measure(u)},droppableContainers:s,measuringConfiguration:a,transform:h})})}function sl(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...nl,...e};return o=>{let{active:i,dragOverlay:c,transform:d,...u}=o;if(!t)return;const f={x:c.rect.left-i.rect.left,y:c.rect.top-i.rect.top},h={scaleX:d.scaleX!==1?i.rect.width*d.scaleX/c.rect.width:1,scaleY:d.scaleY!==1?i.rect.height*d.scaleY/c.rect.height:1},p={x:d.x-f.x,y:d.y-f.y,...h},g=a({...u,active:i,dragOverlay:c,transform:{initial:d,final:p}}),[N]=g,b=g[g.length-1];if(JSON.stringify(N)===JSON.stringify(b))return;const m=s==null?void 0:s({active:i,dragOverlay:c,...u}),j=c.node.animate(g,{duration:t,easing:n,fill:"forwards"});return new Promise(S=>{j.onfinish=()=>{m==null||m(),S()}})}}let pr=0;function al(e){return l.useMemo(()=>{if(e!=null)return pr++,pr},[e])}const ol=V.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:o,modifiers:i,wrapperElement:c="div",className:d,zIndex:u=999}=e;const{activatorEvent:f,active:h,activeNodeRect:p,containerNodeRect:g,draggableNodes:N,droppableContainers:b,dragOverlay:m,over:j,measuringConfiguration:S,scrollableAncestors:w,scrollableAncestorRects:D,windowRect:M}=rs(),R=l.useContext(un),O=al(h==null?void 0:h.id),y=ts(i,{activatorEvent:f,active:h,activeNodeRect:p,containerNodeRect:g,draggingNodeRect:m.rect,over:j,overlayNodeRect:m.rect,scrollableAncestors:w,scrollableAncestorRects:D,transform:R,windowRect:M}),k=$n(p),T=rl({config:s,draggableNodes:N,droppableContainers:b,measuringConfiguration:S}),A=k?m.setRef:void 0;return V.createElement(Vo,null,V.createElement(Xo,{animation:T},h&&O?V.createElement(Zo,{key:O,id:h.id,ref:A,as:c,activatorEvent:f,adjustScale:t,className:d,transition:o,rect:k,style:{zIndex:u,...a},transform:y},n):null))});function hn(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function ll(e,t){return e.reduce((n,s,a)=>{const o=t.get(s);return o&&(n[a]=o),n},Array(e.length))}function Wt(e){return e!==null&&e>=0}function il(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function cl(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Un=e=>{let{rects:t,activeIndex:n,overIndex:s,index:a}=e;const o=hn(t,s,n),i=t[a],c=o[a];return!c||!i?null:{x:c.left-i.left,y:c.top-i.top,scaleX:c.width/i.width,scaleY:c.height/i.height}},qt={scaleX:1,scaleY:1},dl=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:a,rects:o,overIndex:i}=e;const c=(t=o[n])!=null?t:s;if(!c)return null;if(a===n){const u=o[i];return u?{x:0,y:n<i?u.top+u.height-(c.top+c.height):u.top-c.top,...qt}:null}const d=ul(o,a,n);return a>n&&a<=i?{x:0,y:-c.height-d,...qt}:a<n&&a>=i?{x:0,y:c.height+d,...qt}:{x:0,y:0,...qt}};function ul(e,t,n){const s=e[t],a=e[t-1],o=e[t+1];return s?n<t?a?s.top-(a.top+a.height):o?o.top-(s.top+s.height):0:o?o.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const ss="Sortable",as=V.createContext({activeIndex:-1,containerId:ss,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Un,disabled:{draggable:!1,droppable:!1}});function os(e){let{children:t,id:n,items:s,strategy:a=Un,disabled:o=!1}=e;const{active:i,dragOverlay:c,droppableRects:d,over:u,measureDroppableContainers:f}=rs(),h=At(ss,n),p=c.rect!==null,g=l.useMemo(()=>s.map(R=>typeof R=="object"&&"id"in R?R.id:R),[s]),N=i!=null,b=i?g.indexOf(i.id):-1,m=u?g.indexOf(u.id):-1,j=l.useRef(g),S=!il(g,j.current),w=m!==-1&&b===-1||S,D=cl(o);Be(()=>{S&&N&&f(g)},[S,g,N,f]),l.useEffect(()=>{j.current=g},[g]);const M=l.useMemo(()=>({activeIndex:b,containerId:h,disabled:D,disableTransforms:w,items:g,overIndex:m,useDragOverlay:p,sortedRects:ll(g,d),strategy:a}),[b,h,D.draggable,D.droppable,w,g,m,d,p,a]);return V.createElement(as.Provider,{value:M},t)}const hl=e=>{let{id:t,items:n,activeIndex:s,overIndex:a}=e;return hn(n,s,a).indexOf(t)},fl=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:a,items:o,newIndex:i,previousItems:c,previousContainerId:d,transition:u}=e;return!u||!s||c!==o&&a===i?!1:n?!0:i!==a&&t===d},xl={duration:200,easing:"ease"},ls="transform",pl=Xe.Transition.toString({property:ls,duration:0,easing:"linear"}),ml={roleDescription:"sortable"};function gl(e){let{disabled:t,index:n,node:s,rect:a}=e;const[o,i]=l.useState(null),c=l.useRef(n);return Be(()=>{if(!t&&n!==c.current&&s.current){const d=a.current;if(d){const u=yt(s.current,{ignoreTransform:!0}),f={x:d.left-u.left,y:d.top-u.top,scaleX:d.width/u.width,scaleY:d.height/u.height};(f.x||f.y)&&i(f)}}n!==c.current&&(c.current=n)},[t,n,s,a]),l.useEffect(()=>{o&&i(null)},[o]),o}function is(e){let{animateLayoutChanges:t=fl,attributes:n,disabled:s,data:a,getNewIndex:o=hl,id:i,strategy:c,resizeObserverConfig:d,transition:u=xl}=e;const{items:f,containerId:h,activeIndex:p,disabled:g,disableTransforms:N,sortedRects:b,overIndex:m,useDragOverlay:j,strategy:S}=l.useContext(as),w=bl(s,g),D=f.indexOf(i),M=l.useMemo(()=>({sortable:{containerId:h,index:D,items:f},...a}),[h,a,D,f]),R=l.useMemo(()=>f.slice(f.indexOf(i)),[f,i]),{rect:O,node:y,isOver:k,setNodeRef:T}=Ko({id:i,data:M,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...d}}),{active:A,activatorEvent:Y,activeNodeRect:F,attributes:z,setNodeRef:L,listeners:B,isDragging:_,over:he,setActivatorNodeRef:re,transform:H}=Wo({id:i,data:M,attributes:{...ml,...n},disabled:w.draggable}),ye=Ra(T,L),G=!!A,Q=G&&!N&&Wt(p)&&Wt(m),ne=!j&&_,P=ne&&Q?H:null,ie=Q?P??(c??S)({rects:b,activeNodeRect:F,activeIndex:p,overIndex:m,index:D}):null,ee=Wt(p)&&Wt(m)?o({id:i,items:f,activeIndex:p,overIndex:m}):D,$=A==null?void 0:A.id,I=l.useRef({activeId:$,items:f,newIndex:ee,containerId:h}),te=f!==I.current.items,Z=t({active:A,containerId:h,isDragging:_,isSorting:G,id:i,index:D,items:f,newIndex:I.current.newIndex,previousItems:I.current.items,previousContainerId:I.current.containerId,transition:u,wasDragging:I.current.activeId!=null}),oe=gl({disabled:!Z,index:D,node:y,rect:O});return l.useEffect(()=>{G&&I.current.newIndex!==ee&&(I.current.newIndex=ee),h!==I.current.containerId&&(I.current.containerId=h),f!==I.current.items&&(I.current.items=f)},[G,ee,h,f]),l.useEffect(()=>{if($===I.current.activeId)return;if($!=null&&I.current.activeId==null){I.current.activeId=$;return}const Ye=setTimeout(()=>{I.current.activeId=$},50);return()=>clearTimeout(Ye)},[$]),{active:A,activeIndex:p,attributes:z,data:M,rect:O,index:D,newIndex:ee,items:f,isOver:k,isSorting:G,isDragging:_,listeners:B,node:y,overIndex:m,over:he,setNodeRef:ye,setActivatorNodeRef:re,setDroppableNodeRef:T,setDraggableNodeRef:L,transform:oe??ie,transition:W()};function W(){if(oe||te&&I.current.newIndex===D)return pl;if(!(ne&&!ln(Y)||!u)&&(G||Z))return Xe.Transition.toString({...u,property:ls})}}function bl(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}X.Down,X.Right,X.Up,X.Left;function We({children:e}){return r.jsx("label",{className:"block text-[10px] font-semibold uppercase text-text-muted tracking-wider mb-1.5",children:e})}function _e({children:e,className:t=""}){return r.jsx("div",{className:`rounded-lg border border-white/10 bg-white/[0.02] p-3 ${t}`,children:e})}function vl({open:e,onClose:t,onExportHtml:n,onImportFile:s}){const a=dt(),o=de(a.locale),i=l.useRef(null);if(!e)return null;const c=u=>{var h;const f=(h=u.target.files)==null?void 0:h[0];f&&s&&s(f),u.target.value=""},d=u=>u?"bg-accent text-white shadow-[0_0_12px_rgba(129,140,248,0.35)]":"bg-white/5 text-text-secondary hover:bg-white/10 hover:text-white border border-white/5";return r.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:t,children:r.jsxs("div",{className:"bg-sidebar border border-white/10 rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto",role:"dialog","aria-labelledby":"settings-title",onClick:u=>u.stopPropagation(),children:[r.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between px-5 py-3 border-b border-white/10 bg-sidebar/95 backdrop-blur-md",children:[r.jsxs("h2",{id:"settings-title",className:"flex items-center gap-2 text-base font-semibold text-white",children:[r.jsx("span",{className:"material-symbols-outlined text-accent text-[20px]",children:"settings"}),o.settings]}),r.jsx("button",{type:"button",onClick:t,className:"p-1.5 rounded-lg text-text-muted hover:text-white hover:bg-white/10 transition","aria-label":o.close,children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"close"})})]}),r.jsx("div",{className:"p-5",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs(_e,{children:[r.jsx(We,{children:o.language}),r.jsxs("div",{className:"flex gap-1.5",children:[r.jsx("button",{type:"button",onClick:()=>a.setLocale("vi"),className:`flex-1 py-1.5 px-2.5 rounded-lg text-xs font-medium transition ${d(a.locale==="vi")}`,children:o.vietnamese}),r.jsx("button",{type:"button",onClick:()=>a.setLocale("en"),className:`flex-1 py-1.5 px-2.5 rounded-lg text-xs font-medium transition ${d(a.locale==="en")}`,children:o.english})]})]}),r.jsxs(_e,{children:[r.jsx(We,{children:o.displayMode}),r.jsxs("div",{className:"flex gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>a.setTheme("dark"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 px-2.5 rounded-lg text-xs font-medium transition ${d(a.theme==="dark")}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"dark_mode"}),o.dark]}),r.jsxs("button",{type:"button",onClick:()=>a.setTheme("light"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 px-2.5 rounded-lg text-xs font-medium transition ${d(a.theme==="light")}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"light_mode"}),o.light]})]})]}),r.jsxs(_e,{children:[r.jsx(We,{children:"Supabase"}),r.jsx("p",{className:"text-[11px] text-text-muted break-all",title:Xt,children:Xt}),r.jsx("p",{className:"text-[10px] text-text-muted mt-1",children:o.supabaseUrlHint})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(_e,{children:[r.jsx(We,{children:o.backgroundColor}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:ws.map(u=>r.jsx("button",{type:"button",onClick:()=>a.setBackgroundColor(u),className:`w-6 h-6 rounded-md transition ring-2 ring-offset-1 ring-offset-sidebar hover:scale-105 ${a.backgroundColor===u?"ring-accent":"ring-transparent hover:ring-white/30"}`,style:{backgroundColor:u},"aria-label":u},u))})]}),r.jsxs(_e,{children:[r.jsx(We,{children:o.categoryColumns}),r.jsx("div",{className:"flex gap-1.5 flex-wrap",children:[2,3,4,5,6].map(u=>r.jsx("button",{type:"button",onClick:()=>a.setCategoryColumns(u),className:`w-8 h-8 rounded-lg text-xs font-medium transition ${d(a.categoryColumns===u)}`,children:u},u))})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(_e,{children:[r.jsx(We,{children:o.categoryCardHeight}),r.jsxs("div",{className:"flex gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>a.setCategoryCardHeight("auto"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 px-2.5 rounded-lg text-xs font-medium transition ${d(a.categoryCardHeight==="auto")}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"vertical_align_top"}),o.byContent]}),r.jsxs("button",{type:"button",onClick:()=>a.setCategoryCardHeight("equal"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 px-2.5 rounded-lg text-xs font-medium transition ${d(a.categoryCardHeight==="equal")}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"height"}),o.equalHeight]})]})]}),r.jsx(_e,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[10px] font-semibold uppercase text-text-muted tracking-wider",children:o.categoryColorFillContent}),r.jsx("button",{type:"button",onClick:()=>a.setCategoryColorFillContent(!a.categoryColorFillContent),className:`min-w-[60px] px-3 py-1 rounded-full text-[11px] font-medium transition ${a.categoryColorFillContent?"bg-accent/20 text-accent border border-accent/40":"bg-white/10 text-text-muted hover:bg-white/15 border border-white/10"}`,children:a.categoryColorFillContent?o.on:o.off})]})}),r.jsxs(_e,{children:[r.jsx(We,{children:o.openLink}),r.jsxs("div",{className:"flex gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>a.setOpenLinkIn("new_tab"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 px-2.5 rounded-lg text-xs font-medium transition ${d(a.openLinkIn==="new_tab")}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"tab"}),o.newTab]}),r.jsxs("button",{type:"button",onClick:()=>a.setOpenLinkIn("current_tab"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 px-2.5 rounded-lg text-xs font-medium transition ${d(a.openLinkIn==="current_tab")}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"open_in_new"}),o.currentTab]})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(_e,{children:[r.jsx(We,{children:o.importData}),r.jsx("p",{className:"text-[11px] text-text-muted mb-2 leading-relaxed",children:o.importDescription}),r.jsx("input",{ref:i,type:"file",accept:".json,.html,.htm",className:"hidden",onChange:c}),r.jsxs("button",{type:"button",onClick:()=>{var u;return(u=i.current)==null?void 0:u.click()},className:"w-full inline-flex items-center justify-center gap-1.5 py-1.5 px-3 rounded-lg bg-white/5 border border-white/10 text-text-secondary hover:bg-white/10 hover:text-white transition text-xs",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"upload_file"}),o.chooseFile]})]}),r.jsxs(_e,{children:[r.jsx(We,{children:o.exportData}),r.jsx("p",{className:"text-[11px] text-text-muted mb-2 leading-relaxed",children:o.exportDescription}),r.jsxs("button",{type:"button",onClick:n,className:"w-full inline-flex items-center justify-center gap-1.5 py-1.5 px-3 rounded-lg bg-white/5 border border-white/10 text-text-secondary hover:bg-white/10 hover:text-white transition text-xs",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"download"}),o.exportToHtml]})]}),r.jsxs(_e,{children:[r.jsx(We,{children:o.dragDrop}),r.jsx("div",{className:"space-y-1.5",children:[{key:"board",label:o.moveBoard},{key:"category",label:o.moveCategory},{key:"bookmark",label:o.moveBookmark}].map(({key:u,label:f})=>r.jsxs("div",{className:"flex items-center justify-between py-1",children:[r.jsx("span",{className:"text-xs text-text-secondary",children:f}),r.jsx("button",{type:"button",onClick:()=>a.setDragDrop({[u]:!a.dragDrop[u]}),className:`min-w-[44px] px-2.5 py-1 rounded-full text-[11px] font-medium transition ${a.dragDrop[u]?"bg-accent/20 text-accent":"bg-white/10 text-text-muted hover:bg-white/15"}`,children:a.dragDrop[u]?o.on:o.off})]},u))})]})]})]})}),r.jsx("div",{className:"sticky bottom-0 flex justify-end px-5 py-3 border-t border-white/10 bg-sidebar/95 backdrop-blur-md",children:r.jsx("button",{type:"button",onClick:t,className:"py-1.5 px-4 rounded-lg bg-accent text-white text-xs font-medium hover:bg-accent/90 transition shadow-[0_0_12px_rgba(129,140,248,0.25)]",children:o.close})})]})})}function yl({open:e,editBoard:t,onClose:n,onSave:s}){const[a,o]=l.useState(""),[i,c]=l.useState(!1);if(l.useEffect(()=>{e&&o((t==null?void 0:t.name)??"")},[e,t==null?void 0:t.name]),!e)return null;const d=async u=>{if(u.preventDefault(),!!a.trim()){c(!0);try{await s(a.trim(),t==null?void 0:t.id),n()}finally{c(!1)}}};return r.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:n,children:r.jsxs("div",{className:"bg-sidebar border border-white/10 rounded-xl shadow-xl w-full max-w-sm p-4",onClick:u=>u.stopPropagation(),children:[r.jsx("h3",{className:"text-base font-semibold text-white mb-3",children:t?"Sa Board":"Thm Board"}),r.jsxs("form",{onSubmit:d,children:[r.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1.5",children:"Tn board"}),r.jsx("input",{type:"text",value:a,onChange:u=>o(u.target.value),placeholder:"VD: Cng vic",className:"w-full px-3 py-2 rounded-lg text-sm bg-white/5 border border-white/10 text-white placeholder-text-muted focus:ring-2 focus:ring-accent/40 focus:border-accent/40 mb-3",autoFocus:!0}),r.jsxs("div",{className:"flex justify-end gap-1.5",children:[r.jsx("button",{type:"button",onClick:n,className:"px-3 py-1.5 rounded-lg text-xs border border-white/10 text-text-secondary hover:bg-white/10",children:"Hy"}),r.jsx("button",{type:"submit",disabled:i||!a.trim(),className:"px-3 py-1.5 rounded-lg text-xs bg-accent text-white hover:bg-accent/90 disabled:opacity-50",children:i?"ang lu...":"Lu"})]})]})]})})}function Ae({children:e}){return r.jsx("label",{className:"block text-[10px] font-semibold uppercase text-text-muted tracking-wider mb-1",children:e})}function Le({value:e,onChange:t,placeholder:n,rows:s=4,className:a="",error:o,readOnly:i}){return r.jsx("textarea",{value:e,onChange:t?c=>t(c.target.value):void 0,readOnly:i,placeholder:n,rows:s,className:`w-full px-3 py-2 rounded-lg border bg-white/5 text-xs text-white placeholder-text-muted focus:ring-2 focus:ring-accent/40 focus:border-accent/40 resize-y font-mono ${o?"border-red-500/60":"border-white/10"} ${a}`})}const wl={primary:"bg-accent/20 border-accent/50 text-accent hover:bg-accent/30 hover:text-white",success:"bg-emerald-500/20 border-emerald-500/50 text-emerald-400 hover:bg-emerald-500/30 hover:text-white",warning:"bg-amber-500/20 border-amber-500/50 text-amber-400 hover:bg-amber-500/30 hover:text-white",info:"bg-sky-500/20 border-sky-500/50 text-sky-400 hover:bg-sky-500/30 hover:text-white",neutral:"bg-white/5 border-white/10 text-text-secondary hover:bg-white/10 hover:text-white"};function Pe({onClick:e,children:t,disabled:n,variant:s="neutral"}){return r.jsx("button",{type:"button",onClick:e,disabled:n,className:`w-[8.5rem] flex items-center justify-center px-5 py-2.5 rounded-lg text-sm font-medium border disabled:opacity-50 transition ${wl[s]}`,children:t})}function jl(){const[e,t]=l.useState(""),[n,s]=l.useState(""),[a,o]=l.useState(null),i=()=>{o(null);try{const u=JSON.parse(e||"{}");s(JSON.stringify(u,null,2))}catch(u){o(u instanceof Error?u.message:"Invalid JSON"),s("")}},c=()=>{o(null);try{const u=JSON.parse(e||"{}");s(JSON.stringify(u))}catch(u){o(u instanceof Error?u.message:"Invalid JSON"),s("")}},d=()=>{o(null);try{const u=JSON.parse(e||"null");s(JSON.stringify(u,null,2))}catch(u){o(u instanceof Error?u.message:"Invalid JSON"),s("")}};return r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_auto_1fr] gap-5 h-full min-h-0 items-stretch",children:[r.jsxs("div",{className:"flex flex-col min-h-0 flex-1",children:[r.jsx(Ae,{children:"Nhp / Dn JSON"}),r.jsx(Le,{value:e,onChange:t,placeholder:'{"key": "value"}',error:!!a,rows:14,className:"flex-1 min-h-[140px]"}),a&&r.jsx("p",{className:"mt-1.5 text-[11px] text-red-400",children:a})]}),r.jsxs("div",{className:"flex flex-col justify-center gap-2.5 flex-shrink-0",children:[r.jsx(Pe,{onClick:i,variant:"success",children:"Lm p"}),r.jsx(Pe,{onClick:c,variant:"warning",children:"Lm gn"}),r.jsx(Pe,{onClick:d,variant:"primary",children:"Decode"})]}),r.jsxs("div",{className:"flex flex-col min-h-0 flex-1",children:[r.jsx(Ae,{children:"Kt qu"}),r.jsx(Le,{value:n,onChange:void 0,placeholder:"Kt qu hin th  y",readOnly:!0,rows:14,className:"flex-1 min-h-[140px]"})]})]})}function mr(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=t.length%4,s=n?t+"=".repeat(4-n):t;try{return decodeURIComponent(atob(s).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join(""))}catch{return""}}function gr(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(t,n)=>String.fromCharCode(parseInt(n,16)))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function br(e,t){const n=new TextEncoder,s=n.encode(e),a=n.encode(t),o=await crypto.subtle.importKey("raw",s,{name:"HMAC",hash:"SHA-256"},!1,["sign"]),i=await crypto.subtle.sign("HMAC",o,a),c=new Uint8Array(i);let d="";for(let u=0;u<c.length;u++)d+=String.fromCharCode(c[u]);return btoa(d).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Nl(){const[e,t]=l.useState(""),[n,s]=l.useState(""),[a,o]=l.useState(""),[i,c]=l.useState(""),[d,u]=l.useState(null),[f,h]=l.useState(""),[p,g]=l.useState(""),[N,b]=l.useState(""),[m,j]=l.useState(null),S=async()=>{j(null),u(null);const R=e.trim();if(!R){o(""),c("");return}const O=R.split(".");if(O.length!==3){j("JWT phi c 3 phn (header.payload.signature)"),o(""),c("");return}try{const y=mr(O[0]),k=mr(O[1]);if(o(y?(()=>{try{return JSON.stringify(JSON.parse(y),null,2)}catch{return y}})():""),c(k?(()=>{try{return JSON.stringify(JSON.parse(k),null,2)}catch{return k}})():""),n.trim()){const T=await br(n.trim(),`${O[0]}.${O[1]}`),A=O[2];u(T===A)}}catch(y){j(y instanceof Error?y.message:"Li decode"),o(""),c("")}},w=()=>{try{const R=JSON.parse(i||"{}");c(JSON.stringify(R,null,2))}catch{}},D=()=>{try{const R=JSON.parse(i||"{}");c(JSON.stringify(R))}catch{}},M=async()=>{j(null);try{const R=gr(JSON.stringify({alg:"HS256",typ:"JWT"})),O=gr(f.trim()||"{}"),y=`${R}.${O}`;if(p.trim()){const k=await br(p.trim(),y);b(`${y}.${k}`)}else b(`${y}.`)}catch(R){j(R instanceof Error?R.message:"Li encode"),b("")}};return r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_auto_1fr] gap-5 h-full min-h-0 items-stretch",children:[r.jsxs("div",{className:"flex flex-col min-h-0 gap-4 overflow-y-auto flex-1",children:[r.jsxs("div",{className:"rounded-lg border border-violet-500/20 bg-violet-500/5 p-3.5 space-y-2.5 flex-shrink-0",children:[r.jsx(Ae,{children:"Decode"}),r.jsx(Le,{value:e,onChange:t,placeholder:"Dn token JWT",rows:3}),r.jsx("input",{type:"text",value:n,onChange:R=>s(R.target.value),placeholder:"Secret (verify)",className:"w-full px-3 py-2 rounded-lg border border-white/10 bg-white/5 text-xs text-white placeholder-text-muted"}),d!==null&&r.jsxs("p",{className:`text-[11px] ${d?"text-emerald-400":"text-red-400"}`,children:["Ch k: ",d?"Hp l":"Khng hp l"]}),m&&r.jsx("p",{className:"text-[11px] text-red-400",children:m})]}),r.jsxs("div",{className:"rounded-lg border border-amber-500/20 bg-amber-500/5 p-3.5 space-y-2.5 flex-shrink-0",children:[r.jsx(Ae,{children:"Encode"}),r.jsx(Le,{value:f,onChange:h,placeholder:'{"sub":"user123","exp":9999999999}',rows:4}),r.jsx("input",{type:"text",value:p,onChange:R=>g(R.target.value),placeholder:"Secret",className:"w-full px-3 py-2 rounded-lg border border-white/10 bg-white/5 text-xs text-white placeholder-text-muted"})]})]}),r.jsxs("div",{className:"flex flex-col justify-center gap-2.5 flex-shrink-0",children:[r.jsx(Pe,{onClick:S,variant:"info",children:"Decode"}),r.jsx(Pe,{onClick:M,variant:"warning",children:"Encode"})]}),r.jsxs("div",{className:"flex flex-col min-h-0 gap-4 overflow-y-auto flex-1",children:[r.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/[0.02] p-3.5 flex flex-col min-h-0",children:[r.jsx(Ae,{children:"Header"}),r.jsx(Le,{value:a,onChange:void 0,readOnly:!0,rows:3,className:"min-h-[64px]"})]}),r.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/[0.02] p-3.5 flex flex-col min-h-0",children:[r.jsx(Ae,{children:"Payload"}),r.jsx(Le,{value:i,onChange:c,rows:4,className:"min-h-[80px]"}),r.jsxs("div",{className:"mt-1.5 flex gap-2",children:[r.jsx(Pe,{onClick:w,variant:"success",children:"Lm p"}),r.jsx(Pe,{onClick:D,variant:"warning",children:"Lm gn"})]})]}),r.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/[0.02] p-3.5 flex flex-col min-h-0",children:[r.jsx(Ae,{children:"Token"}),r.jsx(Le,{value:N,onChange:void 0,readOnly:!0,rows:2,placeholder:"JWT sau encode",className:"min-h-[56px]"})]})]})]})}function Cl(){const[e,t]=l.useState(""),[n,s]=l.useState(""),[a,o]=l.useState(null),i=()=>{o(null);try{s(encodeURIComponent(e))}catch(d){o(d instanceof Error?d.message:"Li encode"),s("")}},c=()=>{o(null);try{s(decodeURIComponent(e))}catch(d){o(d instanceof Error?d.message:"Li decode"),s("")}};return r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_auto_1fr] gap-5 h-full min-h-0 items-stretch",children:[r.jsxs("div",{className:"flex flex-col min-h-0 flex-1",children:[r.jsx(Ae,{children:"Nhp chui"}),r.jsx(Le,{value:e,onChange:t,placeholder:"https://example.com?q=hello world",rows:14,className:"flex-1 min-h-[140px]"}),a&&r.jsx("p",{className:"mt-1.5 text-[11px] text-red-400",children:a})]}),r.jsxs("div",{className:"flex flex-col justify-center gap-2.5 flex-shrink-0",children:[r.jsx(Pe,{onClick:i,variant:"info",children:"Encode"}),r.jsx(Pe,{onClick:c,variant:"primary",children:"Decode"})]}),r.jsxs("div",{className:"flex flex-col min-h-0 flex-1",children:[r.jsx(Ae,{children:"Kt qu"}),r.jsx(Le,{value:n,onChange:void 0,readOnly:!0,placeholder:"Kt qu",rows:14,className:"flex-1 min-h-[140px]"})]})]})}function Sl(){const[e,t]=l.useState(""),[n,s]=l.useState(""),[a,o]=l.useState(null),i=()=>{o(null);try{s(btoa(unescape(encodeURIComponent(e))))}catch(d){o(d instanceof Error?d.message:"Li encode"),s("")}},c=()=>{o(null);try{s(decodeURIComponent(escape(atob(e.replace(/\s/g,"")))))}catch(d){o(d instanceof Error?d.message:"Chui khng phi Base64 hp l"),s("")}};return r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_auto_1fr] gap-5 h-full min-h-0 items-stretch",children:[r.jsxs("div",{className:"flex flex-col min-h-0 flex-1",children:[r.jsx(Ae,{children:"Nhp chui"}),r.jsx(Le,{value:e,onChange:t,placeholder:"Vn bn hoc Base64",rows:14,className:"flex-1 min-h-[140px]"}),a&&r.jsx("p",{className:"mt-1.5 text-[11px] text-red-400",children:a})]}),r.jsxs("div",{className:"flex flex-col justify-center gap-2.5 flex-shrink-0",children:[r.jsx(Pe,{onClick:i,variant:"success",children:"Encode"}),r.jsx(Pe,{onClick:c,variant:"primary",children:"Decode"})]}),r.jsxs("div",{className:"flex flex-col min-h-0 flex-1",children:[r.jsx(Ae,{children:"Kt qu"}),r.jsx(Le,{value:n,onChange:void 0,readOnly:!0,placeholder:"Kt qu",rows:14,className:"flex-1 min-h-[140px]"})]})]})}const kl={json:{active:"border-accent text-accent bg-accent/10",icon:"data_object"},jwt:{active:"border-violet-500 text-violet-400 bg-violet-500/10",icon:"token"},url:{active:"border-emerald-500 text-emerald-400 bg-emerald-500/10",icon:"link"},base64:{active:"border-amber-500 text-amber-400 bg-amber-500/10",icon:"code"}},El=[{id:"json",label:"JSON"},{id:"jwt",label:"JWT"},{id:"url",label:"URL"},{id:"base64",label:"Base64"}];function Dl({open:e,onClose:t}){const[n,s]=l.useState("json");return e?r.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:t,children:r.jsxs("div",{className:"bg-sidebar border border-white/10 rounded-2xl shadow-2xl w-[80vw] max-w-[80vw] h-[80vh] max-h-[80vh] flex flex-col overflow-hidden",role:"dialog","aria-labelledby":"it-toolbox-title",onClick:a=>a.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10 flex-shrink-0",children:[r.jsxs("h2",{id:"it-toolbox-title",className:"flex items-center gap-2 text-base font-semibold text-white",children:[r.jsx("span",{className:"material-symbols-outlined text-accent text-[20px]",children:"build"}),"IT Tool box"]}),r.jsx("button",{type:"button",onClick:t,className:"p-1.5 rounded-lg text-text-muted hover:text-white hover:bg-white/10 transition","aria-label":"ng",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"close"})})]}),r.jsx("div",{className:"flex border-b border-white/10 px-2 gap-0.5 flex-shrink-0 overflow-x-auto",children:El.map(({id:a,label:o})=>{const i=kl[a];return r.jsxs("button",{type:"button",onClick:()=>s(a),className:`flex items-center gap-1.5 px-3 py-2.5 text-xs font-medium rounded-t-lg border-b-2 transition whitespace-nowrap ${n===a?i.active:"border-transparent text-text-muted hover:text-white hover:bg-white/5"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:i.icon}),o]},a)})}),r.jsx("div",{className:"flex-1 overflow-hidden p-5 min-h-0 flex flex-col",children:r.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden",children:[n==="json"&&r.jsx(jl,{}),n==="jwt"&&r.jsx(Nl,{}),n==="url"&&r.jsx(Cl,{}),n==="base64"&&r.jsx(Sl,{})]})})]})}):null}const Rl="modulepreload",Ol=function(e){return"/"+e},vr={},Il=function(t,n,s){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(n.map(d=>{if(d=Ol(d),d in vr)return;vr[d]=!0;const u=d.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Rl,u||(h.as="script"),h.crossOrigin="",h.href=d,c&&h.setAttribute("nonce",c),document.head.appendChild(h),u)return new Promise((p,g)=>{h.addEventListener("load",p),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return a.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})},yn=30,Dn=[{bg:"from-violet-500 to-purple-600",border:"border-violet-400/50",ring:"ring-violet-400/20"},{bg:"from-blue-500 to-cyan-500",border:"border-blue-400/50",ring:"ring-blue-400/20"},{bg:"from-emerald-500 to-teal-500",border:"border-emerald-400/50",ring:"ring-emerald-400/20"},{bg:"from-amber-500 to-orange-500",border:"border-amber-400/50",ring:"ring-amber-400/20"},{bg:"from-rose-500 to-pink-500",border:"border-rose-400/50",ring:"ring-rose-400/20"},{bg:"from-indigo-500 to-blue-600",border:"border-indigo-400/50",ring:"ring-indigo-400/20"},{bg:"from-fuchsia-500 to-pink-600",border:"border-fuchsia-400/50",ring:"ring-fuchsia-400/20"},{bg:"from-sky-500 to-blue-500",border:"border-sky-400/50",ring:"ring-sky-400/20"}];function cs(e,t){let n=t;for(let s=0;s<(e||"").length;s++)n=n*31+e.charCodeAt(s)>>>0;return Dn[Math.abs(n)%Dn.length]}function Ml(){const[,e]=l.useState(0);l.useEffect(()=>{const t=setInterval(()=>e(n=>n+1),1e3);return()=>clearInterval(t)},[])}function wn({children:e}){return r.jsx("label",{className:"block text-[10px] font-semibold uppercase text-text-muted tracking-wider mb-1",children:e})}function Tl({open:e,onClose:t,userId:n}){const s=dt(),a=de(s.locale),{entries:o,loading:i,addEntry:c,deleteEntry:d,updateOrder:u,refetch:f}=jr(n),[h,p]=l.useState(!1),[g,N]=l.useState("qr"),[b,m]=l.useState(null),[j,S]=l.useState(""),[w,D]=l.useState(""),[M,R]=l.useState(""),[O,y]=l.useState(null),[k,T]=l.useState(null),[A,Y]=l.useState(null),[F,z]=l.useState(null),[L,B]=l.useState(null);Ml(),l.useEffect(()=>{e&&n&&f()},[e,n,f]);const _=l.useCallback(P=>{navigator.clipboard.writeText(P)},[]),he=l.useCallback(async()=>{if(y(null),!M.trim()){y(a.pleaseEnterSecret);return}try{await c(j.trim(),w.trim(),M.trim()),S(""),D(""),R(""),p(!1),N("qr"),m(null)}catch(P){const q=P instanceof Error?P.message:"Li thm ti khon",ee=q&&/schema cache|could not find the table/i.test(q)?` ${a.schemaCacheHint} ${a.connectedTo}: ${Xt}`:"";y(q+ee)}},[c,j,w,M,a]),re=l.useCallback(()=>{p(!1),N("qr"),m(null),y(null),S(""),D(""),R(""),T(null),Y(null),z(null),B(null),F&&URL.revokeObjectURL(F),k&&URL.revokeObjectURL(k)},[F,k]),[H,ye]=l.useState(""),G=o.filter(P=>!H.trim()||P.issuer.toLowerCase().includes(H.toLowerCase())||P.account_name.toLowerCase().includes(H.toLowerCase())),Q=Br(Pr(cn,{activationConstraint:{distance:8}})),ne=l.useCallback(P=>{const{active:q,over:ie}=P;if(!ie||q.id===ie.id)return;const ee=String(q.id),$=String(ie.id),I=o.findIndex(oe=>oe.id===ee),te=o.findIndex(oe=>oe.id===$);if(I===-1||te===-1)return;const Z=hn(o,I,te);u(Z)},[o,u]);return e?r.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:t,children:r.jsx("div",{className:`relative rounded-2xl shadow-2xl flex flex-col overflow-hidden border border-white/5 ${h?"w-[95vw] max-w-[960px] max-h-[90vh] bg-[#182234]":"w-full max-w-[420px] max-h-[800px] h-[75vh] bg-[#151b28]"}`,role:"dialog","aria-labelledby":"authenticator-title",onClick:P=>P.stopPropagation(),children:n?h?r.jsx(Al,{t:a,addMode:g,setAddMode:N,qrSubMode:b,setQrSubMode:m,manualIssuer:j,setManualIssuer:S,manualAccount:w,setManualAccount:D,manualSecret:M,setManualSecret:R,onAddManual:he,onClose:re,addError:O,selectedFile:A,setSelectedFile:Y,imagePreviewUrl:F,setImagePreviewUrl:z,capturedImageUrl:k,setCapturedImageUrl:T,qrDecodeError:L,setQrDecodeError:B,onEntryAdded:()=>{re(),f()},userId:n}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-5 p-6 pb-2 z-10 bg-[#151b28]/95 backdrop-blur-sm sticky top-0 border-b border-white/5",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{id:"authenticator-title",className:"text-white text-2xl font-bold tracking-tight",children:a.authenticator}),r.jsx("button",{type:"button",onClick:t,className:"flex items-center justify-center w-8 h-8 rounded-full text-gray-400 hover:text-white hover:bg-white/5 transition-all","aria-label":a.close,children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"close"})})]}),r.jsxs("div",{className:"relative group",children:[r.jsx("span",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none text-gray-500 group-focus-within:text-accent transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"search"})}),r.jsx("input",{type:"text",value:H,onChange:P=>ye(P.target.value),placeholder:a.searchAccounts,className:"block w-full pl-11 pr-4 py-3 rounded-xl bg-[#1e2532] border-none text-white placeholder-gray-500 focus:ring-1 focus:ring-accent focus:bg-[#232b3a] transition-all text-sm font-medium"})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-2 space-y-1 pb-24 relative",children:[i?r.jsx("p",{className:"text-[#90a4cb] text-sm py-6",children:"ang ti..."}):G.length===0?r.jsx("p",{className:"text-[#90a4cb] text-sm py-6",children:o.length===0?a.noAccountsYet:"Khng c kt qu."}):H.trim()?G.map((P,q)=>r.jsx(ds,{entry:P,onCopy:_,onDelete:()=>d(P.id),t:a,accentColor:cs(P.issuer??"",q)},P.id)):r.jsx(ns,{sensors:Q,collisionDetection:$r,onDragEnd:ne,children:r.jsx(os,{items:o.map(P=>P.id),strategy:dl,children:o.map((P,q)=>r.jsx(_l,{entry:P,index:q,onCopy:_,onDelete:()=>d(P.id),t:a},P.id))})}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-24 bg-gradient-to-t from-[#151b28] to-transparent pointer-events-none z-10","aria-hidden":!0})]}),r.jsx("div",{className:"absolute bottom-6 right-6 z-20",children:r.jsx("button",{type:"button",onClick:()=>p(!0),className:"w-14 h-14 bg-accent rounded-full shadow-[0_0_20px_-5px_rgba(129,140,248,0.5)] flex items-center justify-center text-white hover:opacity-90 active:scale-95 transition-all group","aria-label":a.addAccount,children:r.jsx("span",{className:"material-symbols-outlined text-[28px] group-hover:rotate-90 transition-transform duration-300",children:"add"})})})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10 flex-shrink-0",children:[r.jsx("h2",{id:"authenticator-title",className:"text-xl font-bold tracking-tight text-white",children:a.authenticator}),r.jsx("button",{type:"button",onClick:t,className:"p-2 rounded-lg text-[#90a4cb] hover:text-white hover:bg-white/5","aria-label":a.close,children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsx("p",{className:"text-[#90a4cb] text-sm py-6 px-6",children:a.loginToUseAuthenticator})]})})}):null}function ds({entry:e,onCopy:t,onDelete:n,t:s,accentColor:a}){const[o,i]=l.useState("------"),[c,d]=l.useState(!1),u=Ns(yn),f=u/yn*100,h=u<=5,p=11,g=2*Math.PI*p,N=g-f/100*g,b=a??Dn[0];l.useEffect(()=>{let w=!1;return js(e.secret,yn).then(D=>{w||i(D)}).catch(()=>{w||i("------")}),()=>{w=!0}},[e.secret,u]);const m=()=>{t(o),d(!0),setTimeout(()=>d(!1),1500)},j=o!=="------"?`${o.slice(0,3)} ${o.slice(3)}`:"------",S=(e.issuer||e.account_name||"A").charAt(0).toUpperCase();return r.jsxs("div",{className:`group relative flex items-center justify-between p-3.5 rounded-xl transition-all cursor-pointer border-l-4 ${b.border} hover:bg-[#1e2532] hover:shadow-md hover:ring-1 ${b.ring} border-y border-r border-transparent hover:border-white/5`,onClick:m,children:[r.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[r.jsx("div",{className:`shrink-0 w-11 h-11 rounded-xl bg-gradient-to-br ${b.bg} flex items-center justify-center overflow-hidden shadow-md ring-2 ring-white/20`,children:r.jsx("span",{className:"text-white font-bold text-lg drop-shadow",children:S})}),r.jsxs("div",{className:"flex flex-col min-w-0",children:[r.jsx("span",{className:"text-white font-semibold text-[15px] truncate",children:e.issuer||"Account"}),r.jsx("span",{className:"text-[#90a4cb] text-xs truncate",children:e.account_name||""})]})]}),r.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[r.jsx("span",{className:`font-mono font-semibold text-lg tracking-wider transition-colors ${h?"text-red-400 animate-pulse":"text-white group-hover:text-accent"}`,children:j}),r.jsx("div",{className:"relative w-[28px] h-[28px] flex items-center justify-center shrink-0",title:`${u}s`,children:r.jsxs("svg",{className:"transform -rotate-90 w-full h-full drop-shadow-sm",viewBox:"0 0 28 28",children:[r.jsx("circle",{cx:"14",cy:"14",fill:"transparent",r:p,stroke:"#1e293b",strokeWidth:"2.5"}),r.jsx("circle",{className:"transition-all duration-1000",cx:"14",cy:"14",fill:"transparent",r:p,stroke:h?"#ef4444":"currentColor",strokeDasharray:g,strokeDashoffset:N,strokeLinecap:"round",strokeWidth:"2.5",style:{color:"var(--tw-accent, #818CF8)"}})]})}),r.jsx("button",{type:"button",onClick:w=>{w.stopPropagation(),n()},className:"shrink-0 w-8 h-8 flex items-center justify-center rounded-lg text-[#90a4cb] hover:text-red-400 hover:bg-red-500/10 transition-colors","aria-label":s.delete,children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"delete_outline"})})]}),c&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#1e2532]/95 rounded-xl pointer-events-none",children:r.jsxs("span",{className:"text-accent font-medium text-sm flex items-center gap-1 drop-shadow",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"content_copy"}),s.copied]})})]})}function _l({entry:e,index:t,onCopy:n,onDelete:s,t:a}){const{attributes:o,listeners:i,setNodeRef:c,setActivatorNodeRef:d,transform:u,transition:f,isDragging:h}=is({id:e.id}),p={transform:Xe.Transform.toString(u),transition:f},g=cs(e.issuer??"",t);return r.jsxs("div",{ref:c,style:p,className:`flex items-stretch gap-0 ${h?"opacity-70 scale-[0.98] z-50":""}`,children:[r.jsx("div",{ref:d,...o,...i,className:"flex items-center justify-center w-8 shrink-0 cursor-grab active:cursor-grabbing text-[#64748b] hover:text-[#94a3b8] touch-none","aria-label":a.dragDrop,children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"drag_indicator"})}),r.jsx("div",{className:"flex-1 min-w-0",children:r.jsx(ds,{entry:e,onCopy:n,onDelete:s,t:a,accentColor:g})})]})}function Al(e){var z;const{t,addMode:n,setAddMode:s,setQrSubMode:a,manualIssuer:o,setManualIssuer:i,manualAccount:c,setManualAccount:d,manualSecret:u,setManualSecret:f,onAddManual:h,onClose:p,addError:g,setSelectedFile:N,setImagePreviewUrl:b,setCapturedImageUrl:m,setQrDecodeError:j,onEntryAdded:S,userId:w}=e,D=V.useRef(null),[M,R]=l.useState(!1),O=e.imagePreviewUrl||e.capturedImageUrl,y=l.useCallback(L=>{var _;if(!L||!L.type.startsWith("image/"))return;j(null),N(L),(_=e.imagePreviewUrl)!=null&&_.startsWith("blob:")&&URL.revokeObjectURL(e.imagePreviewUrl),m(null);const B=new FileReader;B.onload=()=>{b(B.result)},B.onerror=()=>{j(t.decodeError)},B.readAsDataURL(L)},[e.imagePreviewUrl,b,m,N,j,t.decodeError]),k=L=>{var _;const B=(_=L.target.files)==null?void 0:_[0];B&&y(B),L.target.value=""},T=L=>{L.preventDefault(),L.stopPropagation(),L.dataTransfer.types.includes("Files")&&(L.dataTransfer.dropEffect="copy"),R(!0)},A=L=>{L.preventDefault(),L.stopPropagation(),L.currentTarget.contains(L.relatedTarget)||R(!1)},Y=L=>{var _;L.preventDefault(),L.stopPropagation(),R(!1);const B=(_=L.dataTransfer.files)==null?void 0:_[0];B&&y(B)},F=l.useCallback(()=>{var L;if(j(null),typeof chrome>"u"||!((L=chrome.runtime)!=null&&L.sendMessage)){j(t.captureNotAvailable);return}chrome.runtime.sendMessage({type:"CAPTURE_VISIBLE_TAB"},B=>{const _=chrome.runtime.lastError;if(_){j(t.captureError+(_.message?` (${_.message})`:""));return}B!=null&&B.ok&&B.dataUrl?(e.capturedImageUrl&&URL.revokeObjectURL(e.capturedImageUrl),m(B.dataUrl)):B&&!B.ok&&j(t.captureError+(B.error?` (${B.error})`:""))})},[m,j,e.capturedImageUrl,t]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-[#314368] shrink-0",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("h1",{className:"text-xl font-bold tracking-tight text-white",children:t.addNewAuthenticator}),r.jsx("p",{className:"text-sm text-[#90a4cb]",children:t.chooseHowToAdd})]}),r.jsx("button",{type:"button",onClick:p,className:"p-2 rounded-lg text-[#90a4cb] hover:text-white hover:bg-white/5 transition-colors","aria-label":t.close,children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),n==="manual"?r.jsx("div",{className:"overflow-y-auto p-6 md:p-8",children:r.jsxs("div",{className:"max-w-md space-y-4",children:[r.jsxs("div",{children:[r.jsx(wn,{children:t.issuer}),r.jsx("input",{type:"text",value:o,onChange:L=>i(L.target.value),placeholder:"Google",className:"w-full px-3 py-2.5 rounded-lg border border-[#314368] bg-[#1e2532] text-sm text-white placeholder-[#90a4cb] focus:ring-1 focus:ring-accent"})]}),r.jsxs("div",{children:[r.jsx(wn,{children:t.accountName}),r.jsx("input",{type:"text",value:c,onChange:L=>d(L.target.value),placeholder:"user@gmail.com",className:"w-full px-3 py-2.5 rounded-lg border border-[#314368] bg-[#1e2532] text-sm text-white placeholder-[#90a4cb] focus:ring-1 focus:ring-accent"})]}),r.jsxs("div",{children:[r.jsx(wn,{children:t.secretBase32}),r.jsx("input",{type:"text",value:u,onChange:L=>f(L.target.value),placeholder:"JBSWY3DPEHPK3PXP",className:"w-full px-3 py-2.5 rounded-lg border border-[#314368] bg-[#1e2532] text-sm text-white font-mono placeholder-[#90a4cb] focus:ring-1 focus:ring-accent"})]}),g&&r.jsx("p",{className:"text-sm text-red-400",children:g}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"button",onClick:h,className:"px-6 py-2.5 rounded-lg bg-accent/20 text-accent border border-accent/50 text-sm font-semibold hover:bg-accent/30 transition-colors",children:t.add}),r.jsx("button",{type:"button",onClick:p,className:"px-6 py-2.5 rounded-lg border border-[#314368] text-sm font-medium text-white hover:bg-white/5 transition-colors",children:t.cancel})]})]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-y-auto p-6 md:p-8 flex-1 min-h-0",children:r.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-stretch",children:[r.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:"material-symbols-outlined text-accent",children:"qr_code_scanner"}),r.jsx("h2",{className:"text-base font-semibold text-white",children:t.scanQRCode})]}),r.jsxs("div",{className:"relative w-full aspect-[4/3] bg-black rounded-xl overflow-hidden border border-[#314368] ring-2 ring-transparent ring-offset-2 ring-offset-[#182234] focus-within:ring-accent",children:[O?r.jsx("div",{className:"absolute inset-0 flex flex-col",children:r.jsx(Ll,{t,imageUrl:O,userId:w,onEntryAdded:S,onError:e.setQrDecodeError,embedded:!0,fileType:(z=e.selectedFile)==null?void 0:z.type})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"absolute inset-0 bg-[#1e2532] flex items-center justify-center p-8 md:p-12",children:r.jsxs("div",{className:"relative w-full h-full max-w-[280px] max-h-[280px] flex items-center justify-center",children:[r.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-white/80 rounded-tl-lg"}),r.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-white/80 rounded-tr-lg"}),r.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-white/80 rounded-bl-lg"}),r.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-white/80 rounded-br-lg"}),r.jsx("div",{className:"absolute left-0 right-0 h-0.5 bg-accent animate-pulse opacity-80",style:{boxShadow:"0 0 15px rgba(129,140,248,0.8)"}})]})}),r.jsx("p",{className:"absolute bottom-4 left-0 right-0 text-center text-sm text-[#90a4cb] px-4",children:t.uploadScreenshotQR})]}),e.qrDecodeError&&r.jsx("p",{className:"absolute top-2 left-2 right-2 text-xs text-red-400 bg-black/60 px-2 py-1 rounded",children:e.qrDecodeError})]}),r.jsx("p",{className:"text-sm text-[#90a4cb] text-center",children:t.pointCameraAtQR})]}),r.jsxs("div",{className:"flex md:flex-col items-center justify-center gap-4 text-[#90a4cb] shrink-0",children:[r.jsx("div",{className:"h-px w-full md:w-px md:h-16 bg-[#314368]"}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider px-2",children:"OR"}),r.jsx("div",{className:"h-px w-full md:w-px md:h-16 bg-[#314368]"})]}),r.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:"material-symbols-outlined text-accent",children:"upload_file"}),r.jsx("h2",{className:"text-base font-semibold text-white",children:t.uploadQRImage})]}),r.jsxs("label",{className:`flex-1 min-h-[240px] flex flex-col items-center justify-center gap-4 rounded-xl border-2 border-dashed transition-all cursor-pointer p-6 text-center group ${M?"border-accent bg-accent/10":"border-[#314368] bg-white/5 hover:bg-white/10 hover:border-accent/50"}`,onDragOver:T,onDragLeave:A,onDrop:Y,children:[r.jsx("input",{ref:D,type:"file",accept:"image/*,.svg,.svgz",onChange:k,className:"hidden"}),r.jsx("div",{className:"w-16 h-16 rounded-full bg-[#182234] flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300",children:r.jsx("span",{className:"material-symbols-outlined text-3xl text-accent",children:"cloud_upload"})}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("p",{className:"text-lg font-bold text-white",children:t.clickOrDragFile}),r.jsx("p",{className:"text-sm text-[#90a4cb] max-w-[200px]",children:t.supportsPNGJPG})]}),r.jsx("span",{className:"mt-2 px-4 py-2 bg-[#182234] border border-[#314368] rounded-lg text-sm font-medium text-white shadow-sm hover:bg-[#222f49] transition-colors",onClick:L=>{var B;L.preventDefault(),(B=D.current)==null||B.click()},children:t.selectFile})]}),r.jsx("p",{className:"text-sm text-[#90a4cb] text-center",children:t.uploadScreenshotQR}),r.jsx("div",{className:"flex gap-2 justify-center",children:r.jsx("button",{type:"button",onClick:F,className:"px-3 py-2 rounded-lg text-xs font-medium border border-[#314368] text-[#90a4cb] hover:bg-white/5 hover:text-white transition-colors",children:t.captureScreen})})]})]})}),r.jsxs("div",{className:"bg-[#182234] border-t border-[#314368] p-6 rounded-b-2xl flex flex-col sm:flex-row items-center justify-between gap-4 shrink-0",children:[r.jsxs("button",{type:"button",onClick:()=>s("manual"),className:"flex items-center gap-2 text-sm text-[#90a4cb] hover:text-white transition-colors group",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] group-hover:text-accent transition-colors",children:"keyboard"}),r.jsx("span",{children:t.cantScanEnterManually})]}),r.jsx("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:r.jsx("button",{type:"button",onClick:p,className:"flex-1 sm:flex-none px-6 py-2.5 rounded-lg border border-[#314368] text-sm font-medium text-white hover:bg-white/5 transition-colors",children:t.cancel})})]})]})]})}function Ll({t:e,imageUrl:t,userId:n,onEntryAdded:s,onError:a,embedded:o,fileType:i}){const c=V.useRef(null),d=V.useRef(null),[u,f]=l.useState(null),[h,p]=l.useState(null),[g,N]=l.useState(null),[b,m]=l.useState(!1),j=V.useRef(null),{addEntry:S}=jr(n),w=y=>{const k=y.currentTarget;j.current=k,N({w:k.naturalWidth,h:k.naturalHeight})},D=y=>{if(!d.current)return;const k=d.current.getBoundingClientRect();p({x:y.clientX-k.left,y:y.clientY-k.top}),f(null)},M=y=>{if(!h||!d.current)return;const k=d.current.getBoundingClientRect(),T=y.clientX-k.left,A=y.clientY-k.top;f({x:Math.min(h.x,T),y:Math.min(h.y,A),w:Math.abs(T-h.x),h:Math.abs(A-h.y)})},R=()=>{p(null)},O=l.useCallback(async()=>{var k;if(!j.current||!c.current)return;if(i==="image/svg+xml"){a(e.svgNotSupportedForScan);return}const y=j.current;if(!y.complete||y.naturalWidth===0||y.naturalHeight===0){a(e.imageNotLoaded);return}m(!0),a(null);try{const T=c.current,A=T.getContext("2d");if(!A)throw new Error("No canvas context");let Y=0,F=0,z=y.naturalWidth,L=y.naturalHeight;const B=(k=d.current)==null?void 0:k.getBoundingClientRect();if(B&&B.width>0&&B.height>0&&u&&u.w>10&&u.h>10){const $=y.naturalWidth/B.width,I=y.naturalHeight/B.height;Y=Math.round(u.x*$),F=Math.round(u.y*I),z=Math.round(u.w*$),L=Math.round(u.h*I)}(z<10||L<10)&&(z=y.naturalWidth,L=y.naturalHeight);let _;try{T.width=z,T.height=L,A.drawImage(y,Y,F,z,L,0,0,z,L),_=A.getImageData(0,0,z,L)}catch($){const I=$ instanceof Error&&($.name==="SecurityError"||/tainted|getImageData/i.test($.message));a(I?e.canvasTaintedError:$ instanceof Error?$.message:e.decodeError);return}const he=(await Il(async()=>{const{default:$}=await import("./jsQR-CSvrzA8D.js").then(I=>I.j);return{default:$}},__vite__mapDeps([0,1,2]))).default,re=($,I,te)=>he($,I,te);let H=re(_.data,_.width,_.height);if(!(H!=null&&H.data)){const $=new Uint8ClampedArray(_.data.length);for(let I=0;I<_.data.length;I+=4)$[I]=255-_.data[I],$[I+1]=255-_.data[I+1],$[I+2]=255-_.data[I+2],$[I+3]=_.data[I+3];H=re($,_.width,_.height)}if(!(H!=null&&H.data)&&(z>1e3||L>1e3))try{const I=800/Math.max(z,L),te=Math.round(z*I),Z=Math.round(L*I);if(T.width=te,T.height=Z,A.drawImage(y,Y,F,z,L,0,0,te,Z),_=A.getImageData(0,0,te,Z),H=re(_.data,_.width,_.height),!(H!=null&&H.data)){const oe=new Uint8ClampedArray(_.data.length);for(let W=0;W<_.data.length;W+=4)oe[W]=255-_.data[W],oe[W+1]=255-_.data[W+1],oe[W+2]=255-_.data[W+2],oe[W+3]=_.data[W+3];H=re(oe,_.width,_.height)}}catch{}if(!H||!H.data){a(e.qrNotFound);return}const ye=H.data;if(!ye.startsWith("otpauth://")){a(e.invalidOtpauth);return}const G=new URL(ye.replace("otpauth://","https://x/")),Q=G.searchParams.get("secret");if(!Q){a(e.noSecretInQR);return}const ne=G.pathname.replace(/^\/totp\/?/i,"").replace(/^\//,""),P=decodeURIComponent(ne||""),q=G.searchParams.get("issuer")||"",ie=q?decodeURIComponent(q):P.split(":")[0]||"Unknown",ee=P.includes(":")?P.split(":").slice(1).join(":").trim():P||"Account";try{await S(ie,ee,Q),s()}catch($){const I=$ instanceof Error?$.message:$&&typeof $=="object"&&"message"in $?String($.message):typeof $=="string"?$:"",Z=I&&/schema cache|could not find the table/i.test(I)?` ${e.schemaCacheHint} ${e.connectedTo}: ${Xt}`:"";a(I?`${e.saveAccountError} ${I}.${Z}`:e.saveAccountError)}}catch(T){const A=T instanceof Error?T.message:T&&typeof T=="object"&&"message"in T?String(T.message):typeof T=="string"?T:"";a(A&&A!=="undefined"?A:e.decodeError)}finally{m(!1)}},[u,i,S,s,a,e]);return r.jsxs("div",{className:o?"absolute inset-0 flex flex-col overflow-auto p-3":"space-y-3",children:[!o&&r.jsx("p",{className:"text-[11px] text-text-muted",children:e.selectRegionThenScan}),r.jsxs("div",{ref:d,className:`relative overflow-hidden flex items-center justify-center ${o?"flex-1 min-h-0 rounded-lg bg-black/20":"border border-white/10 rounded-lg bg-black/20 max-h-[280px]"}`,onMouseDown:D,onMouseMove:M,onMouseUp:R,onMouseLeave:R,children:[r.jsx("img",{src:t,alt:"QR",className:o?"max-w-full max-h-full object-contain select-none":"max-w-full max-h-[260px] object-contain select-none",draggable:!1,onLoad:w,style:{pointerEvents:"none"}}),u&&u.w>5&&u.h>5&&r.jsx("div",{className:"absolute border-2 border-accent pointer-events-none",style:{left:u.x,top:u.y,width:u.w,height:u.h}})]}),r.jsx("canvas",{ref:c,className:"hidden"}),r.jsx("button",{type:"button",onClick:O,disabled:b,className:o?"mt-2 shrink-0 px-4 py-2 rounded-lg text-xs font-medium bg-accent/20 text-accent border border-accent/50 hover:bg-accent/30 disabled:opacity-50":"px-4 py-2 rounded-lg text-xs font-medium bg-accent/20 text-accent border border-accent/50 hover:bg-accent/30 disabled:opacity-50",children:b?e.decoding:e.scanCode})]})}const Pl=["#818CF8","#10B981","#A855F7","#FB923C","#EC4899","#3B82F6","#EAB308","#06B6D4","#F43F5E","#8B5CF6"];function Bl({open:e,boardId:t,editCategory:n,boards:s=[],onClose:a,onSave:o,onMoveToBoard:i}){var O;const[c,d]=l.useState(""),[u,f]=l.useState(!1),[h,p]=l.useState("#818CF8"),[g,N]=l.useState(15),[b,m]=l.useState(!1),[j,S]=l.useState("");if(l.useEffect(()=>{if(e){if(d((n==null?void 0:n.name)??""),n!=null&&n.color&&n.color.length===9){const y=n.color.slice(0,7),k=n.color.slice(7,9),T=parseInt(k,16),A=Math.round(T/255*100);f(!0),p(y),N(Number.isFinite(A)?A:15)}else n!=null&&n.color?(f(!0),p(n.color),N(15)):(f(!1),p("#818CF8"),N(15));S("")}},[e,n==null?void 0:n.name,n==null?void 0:n.color]),!e)return null;const w=n!=null&&n.board_id?s.filter(y=>y.id!==n.board_id).sort((y,k)=>y.sort_order-k.sort_order):s.slice().sort((y,k)=>y.sort_order-k.sort_order),D=!!n&&w.length>0&&i,M=async y=>{if(y.preventDefault(),!!c.trim()){m(!0);try{const k=u?`${h}${Math.round(g/100*255).toString(16).padStart(2,"0")}`:null;await o(c.trim(),k,n==null?void 0:n.id),a()}finally{m(!1)}}},R=()=>{n!=null&&n.id&&j&&i&&(i(n.id,j),a())};return r.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:a,children:r.jsxs("div",{className:"bg-sidebar border border-white/10 rounded-xl shadow-xl w-full max-w-sm p-4",onClick:y=>y.stopPropagation(),children:[r.jsx("h3",{className:"text-base font-semibold text-white mb-3",children:n?"Sa Category":"Thm Category"}),r.jsxs("form",{onSubmit:M,children:[r.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1.5",children:"Tn category"}),r.jsx("input",{type:"text",value:c,onChange:y=>d(y.target.value),placeholder:"VD: Admin Portals",className:"w-full px-3 py-2 rounded-lg text-sm bg-white/5 border border-white/10 text-white placeholder-text-muted focus:ring-2 focus:ring-accent/40 focus:border-accent/40 mb-3",autoFocus:!0}),r.jsxs("div",{className:"mb-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[r.jsx("label",{className:"block text-xs font-medium text-text-secondary",children:"Mu category"}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted",children:[r.jsx("button",{type:"button",onClick:()=>f(!1),className:`px-2 py-0.5 rounded-full border text-[11px] ${u?"border-white/10 text-text-muted hover:border-white/30":"border-accent bg-accent/20 text-accent"}`,children:"Mc nh"}),r.jsx("button",{type:"button",onClick:()=>f(!0),className:`px-2 py-0.5 rounded-full border text-[11px] ${u?"border-accent bg-accent/20 text-accent":"border-white/10 text-text-muted hover:border-white/30"}`,children:"Tu chnh"})]})]}),u&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:Pl.map(y=>r.jsx("button",{type:"button",onClick:()=>p(y),className:`w-6 h-6 rounded-md transition ring-2 ring-offset-1 ring-offset-sidebar ${h===y?"ring-white":"ring-transparent hover:ring-white/30"}`,style:{backgroundColor:y}},y))}),r.jsxs("div",{className:"mb-2",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("span",{className:"text-[11px] text-text-secondary",children:" m nn (Opacity)"}),r.jsxs("span",{className:"text-[11px] text-text-muted",children:[g,"%"]})]}),r.jsx("input",{type:"range",min:5,max:40,step:1,value:g,onChange:y=>N(Number(y.target.value)),className:"w-full accent-accent"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[11px] text-text-muted",children:"Xem trc:"}),r.jsx("div",{className:"flex-1 px-3 py-2 rounded-lg border border-white/10 text-[11px] text-white/90",style:{backgroundColor:`${h}${Math.round(g/100*255).toString(16).padStart(2,"0")}`},children:"Category preview"})]})]})]}),D&&r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1.5",children:"Di chuyn sang board"}),r.jsxs("select",{value:j,onChange:y=>S(y.target.value),className:"w-full px-3 py-2 rounded-lg text-sm bg-white/5 border border-white/10 text-white focus:ring-2 focus:ring-accent/40 focus:border-accent/40",children:[r.jsx("option",{value:"",children:" Chn board "}),w.map(y=>r.jsx("option",{value:y.id,children:y.name},y.id))]}),j&&r.jsxs("button",{type:"button",onClick:R,className:"mt-1.5 w-full px-3 py-1.5 rounded-lg text-xs border border-accent/50 text-accent hover:bg-accent/10 flex items-center justify-center gap-1.5",children:[r.jsx("span",{className:"material-icons-round text-[14px]",children:"drive_file_move"}),'Move to "',(O=w.find(y=>y.id===j))==null?void 0:O.name,'"']})]}),r.jsxs("div",{className:"flex justify-end gap-1.5",children:[r.jsx("button",{type:"button",onClick:a,className:"px-3 py-1.5 rounded-lg text-xs border border-white/10 text-text-secondary hover:bg-white/10",children:"Hy"}),r.jsx("button",{type:"submit",disabled:b||!c.trim(),className:"px-3 py-1.5 rounded-lg text-xs bg-accent text-white hover:bg-accent/90 disabled:opacity-50",children:b?"ang lu...":"Lu"})]})]})]})})}function $l({open:e,categories:t,editBookmark:n,initialUrl:s="",initialTitle:a="",defaultCategoryId:o,onClose:i,onSave:c}){const[d,u]=l.useState(""),[f,h]=l.useState(""),[p,g]=l.useState(""),[N,b]=l.useState(""),[m,j]=l.useState(!1);if(l.useEffect(()=>{var w;e&&(u((n==null?void 0:n.url)??s),h((n==null?void 0:n.title)??a),g((n==null?void 0:n.description)??""),b((n==null?void 0:n.category_id)??o??((w=t[0])==null?void 0:w.id)??""))},[e,n,s,a,o,t]),!e)return null;const S=async w=>{if(w.preventDefault(),!(!d.trim()||!f.trim()||!N)){j(!0);try{await c({url:d.trim(),title:f.trim(),description:p.trim(),category_id:N},n==null?void 0:n.id),i()}finally{j(!1)}}};return r.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:i,children:r.jsxs("div",{className:"bg-sidebar border border-white/10 rounded-xl shadow-xl w-full max-w-md p-4 max-h-[90vh] overflow-y-auto",onClick:w=>w.stopPropagation(),children:[r.jsx("h3",{className:"text-base font-semibold text-white mb-3",children:n?"Sa Bookmark":"Thm Bookmark"}),r.jsxs("form",{onSubmit:S,className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1.5",children:"URL *"}),r.jsx("input",{type:"url",value:d,onChange:w=>u(w.target.value),placeholder:"https://...",className:"w-full px-3 py-2 rounded-lg text-sm bg-white/5 border border-white/10 text-white placeholder-text-muted focus:ring-2 focus:ring-accent/40",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1.5",children:"Tiu  *"}),r.jsx("input",{type:"text",value:f,onChange:w=>h(w.target.value),placeholder:"Tn bookmark",className:"w-full px-3 py-2 rounded-lg text-sm bg-white/5 border border-white/10 text-white placeholder-text-muted focus:ring-2 focus:ring-accent/40",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1.5",children:"M t"}),r.jsx("input",{type:"text",value:p,onChange:w=>g(w.target.value),placeholder:"Ty chn",className:"w-full px-3 py-2 rounded-lg text-sm bg-white/5 border border-white/10 text-white placeholder-text-muted focus:ring-2 focus:ring-accent/40"})]}),!n&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1.5",children:"Category"}),r.jsx("select",{value:N,onChange:w=>b(w.target.value),className:"w-full px-3 py-2 rounded-lg text-sm bg-white/5 border border-white/10 text-white focus:ring-2 focus:ring-accent/40",children:t.map(w=>r.jsx("option",{value:w.id,className:"bg-sidebar",children:w.name},w.id))})]}),r.jsxs("div",{className:"flex justify-end gap-1.5 pt-2",children:[r.jsx("button",{type:"button",onClick:i,className:"px-3 py-1.5 rounded-lg text-xs border border-white/10 text-text-secondary hover:bg-white/10",children:"Hy"}),r.jsx("button",{type:"submit",disabled:m||!d.trim()||!f.trim(),className:"px-3 py-1.5 rounded-lg text-xs bg-accent text-white hover:bg-accent/90 disabled:opacity-50",children:m?"ang lu...":"Lu"})]})]})]})})}function Ul({open:e,title:t,message:n,confirmLabel:s="Xa",danger:a=!0,onConfirm:o,onCancel:i}){return e?r.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:i,children:r.jsxs("div",{className:"bg-sidebar border border-white/10 rounded-xl shadow-xl w-full max-w-sm p-4",onClick:c=>c.stopPropagation(),children:[r.jsx("h3",{className:"text-base font-semibold text-white mb-1.5",children:t}),r.jsx("p",{className:"text-xs text-text-secondary mb-4",children:n}),r.jsxs("div",{className:"flex justify-end gap-1.5",children:[r.jsx("button",{type:"button",onClick:i,className:"px-3 py-1.5 rounded-lg text-xs border border-white/10 text-text-secondary hover:bg-white/10",children:"Hy"}),r.jsx("button",{type:"button",onClick:o,className:`px-3 py-1.5 rounded-lg text-xs font-medium ${a?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-accent text-white hover:bg-accent/90"}`,children:s})]})]})}):null}function yr(e,t){const n=["<!DOCTYPE NETSCAPE-Bookmark-file-1>","<!-- This is an automatically generated file. -->",'<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">',"<TITLE>Bookmarks</TITLE>","<H1>Bookmarks</H1>","<DL><p>"];return e.forEach(s=>{n.push("    <DT><H3>",Jt(s.name),"</H3>"),n.push("    <DL><p>"),t.filter(o=>o.category.board_id===s.id).forEach(({category:o,bookmarks:i})=>{n.push("        <DT><H3>",Jt(o.name),"</H3>"),n.push("        <DL><p>"),i.forEach(c=>{const d=Math.floor(new Date(c.created_at).getTime()/1e3);n.push('            <DT><A HREF="',Jt(c.url),'" ADD_DATE="',d,'">',Jt(c.title||c.url),"</A>")}),n.push("        </DL><p>")}),n.push("    </DL><p>")}),n.push("</DL><p>"),n.join("")}function Jt(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function wr(e,t="linkhub-bookmarks.html"){const n=new Blob([e],{type:"text/html;charset=utf-8"}),s=URL.createObjectURL(n),a=document.createElement("a");a.href=s,a.download=t,a.click(),URL.revokeObjectURL(s)}const xt=["#818CF8","#10B981","#A855F7","#FB923C","#EC4899","#3B82F6","#EAB308","#06B6D4"];function Fl({category:e,activeCategoryId:t,fallbackDotColor:n,searchQuery:s,onOpenBookmark:a,cardHeight:o,fillContent:i,categoryMenuId:c,onOpenCategoryMenu:d,onEditCategory:u,onDuplicateCategory:f,onDeleteCategory:h,onAddBookmark:p,onEditBookmark:g,onDuplicateBookmark:N,onMoveBookmark:b,onDeleteBookmark:m,dragDropBookmark:j,draggedBookmark:S,dropBookmarkTarget:w,onBookmarkDragStart:D,onBookmarkDragOver:M,onBookmarkDrop:R,onBookmarkDragEnd:O}){const{attributes:y,listeners:k,setNodeRef:T,transform:A,transition:Y,isDragging:F}=is({id:e.id,transition:{duration:150,easing:"ease"}}),z=F||t===e.id,L={transform:Xe.Transform.toString(A),transition:Y,opacity:z?0:1,pointerEvents:z?"none":void 0};return r.jsx("div",{ref:T,style:L,className:"break-inside-avoid",...y,...k,children:r.jsx(Rn,{category:e,fallbackDotColor:n,searchQuery:s,onOpenBookmark:a,cardHeight:o,fillContent:i,categoryMenuId:c,onOpenCategoryMenu:d,onEditCategory:u,onDuplicateCategory:f,onDeleteCategory:h,onAddBookmark:p,onEditBookmark:g,onDuplicateBookmark:N,onMoveBookmark:b,onDeleteBookmark:m,dragDropCategory:!0,sortableWrapper:!0,isDraggingCategory:F||t===e.id,dragDropBookmark:j,draggedBookmark:S,dropBookmarkTarget:w,onBookmarkDragStart:D,onBookmarkDragOver:M,onBookmarkDrop:R,onBookmarkDragEnd:O})})}function zl({initialAddBookmark:e,initialOpenAuthenticator:t,initialOpenItTools:n}){var Jn,Kn;const{user:s}=Nr(),a=dt(),{boards:o,setBoards:i,loading:c,error:d,refetch:u}=Cs(s==null?void 0:s.id),[f,h]=l.useState(null),{categories:p,setCategories:g,loading:N,refetch:b}=Ss(f),[m,j]=l.useState(""),[S,w]=l.useState(!0),[D,M]=l.useState(!1),[R,O]=l.useState([]),[y,k]=l.useState([]),[T,A]=l.useState(!1),[Y,F]=l.useState(!!e),[z,L]=l.useState(!1),[B,_]=l.useState(!1),he=l.useRef(null),[re,H]=l.useState(!1),[ye,G]=l.useState(!!t),[Q,ne]=l.useState(!!n),[P,q]=l.useState(null),[ie,ee]=l.useState(null),[$,I]=l.useState(!1),[te,Z]=l.useState(null),[oe,W]=l.useState(null),[Ye,Ce]=l.useState(!1),[Pt,Ve]=l.useState(null),[wt,Se]=l.useState(null),[qe,Je]=l.useState(null),[st,Ue]=l.useState({open:!1,title:"",message:"",onConfirm:()=>{}}),[Bt,at]=l.useState(null),[Oe,ke]=l.useState(null),[Fe,jt]=l.useState(null),[we,Ie]=l.useState(null),[ot,ze]=l.useState(null),lt=l.useRef(null),Nt=l.useRef(null),$t=l.useRef(null),[Ut,fn]=l.useState(!1),Ft=l.useRef(null),zt=l.useRef(null),[fe,ge]=l.useState(!1),se=m.trim().toLowerCase(),me=l.useMemo(()=>{if(!se)return null;const x=o.filter(E=>E.name.toLowerCase().includes(se)),C=R.filter(E=>E.name.toLowerCase().includes(se)),v=y.filter(E=>(E.title??"").toLowerCase().includes(se)||(E.url??"").toLowerCase().includes(se));return{boardMatches:x,categoryMatches:C,bookmarkMatches:v}},[se,o,R,y]);l.useEffect(()=>{const x=C=>{const v=C.target;he.current&&!he.current.contains(v)&&_(!1),lt.current&&!lt.current.contains(v)&&ee(null),oe&&!C.target.closest("[data-category-menu]")&&W(null)};return document.addEventListener("click",x),()=>document.removeEventListener("click",x)},[oe]),l.useEffect(()=>{s!=null&&s.id&&(A(!0),(async()=>{try{const{data:x}=await K.from("categories").select("*").order("sort_order");O(x??[]);const{data:C}=await K.from("bookmarks").select("*").order("sort_order");k(C??[])}finally{A(!1)}})())},[s==null?void 0:s.id]),l.useEffect(()=>{if(!ie)return;const C=requestAnimationFrame(()=>{const v=Nt.current,E=$t.current;if(!v||!E)return;const U=v.getBoundingClientRect(),J=E.getBoundingClientRect(),ae=window.innerHeight-U.bottom;fn(ae<J.height)});return()=>cancelAnimationFrame(C)},[ie]),l.useEffect(()=>{if(!B)return;const C=requestAnimationFrame(()=>{const v=zt.current,E=Ft.current;if(!v||!E)return;const U=v.getBoundingClientRect(),J=E.getBoundingClientRect(),ae=window.innerHeight-U.bottom;ge(ae<J.height)});return()=>cancelAnimationFrame(C)},[B]),l.useEffect(()=>{e&&F(!0)},[e]),l.useEffect(()=>{t&&G(!0)},[t]),l.useEffect(()=>{var C;let x=!1;try{if(typeof window<"u"){const v=window.localStorage.getItem("lastSidebarOpen");v!==null&&w(v==="true");const E=window.localStorage.getItem("lastSelectedBoardId");E&&h(E)}}catch{}try{if(typeof chrome<"u"&&((C=chrome.storage)!=null&&C.local)){chrome.storage.local.get(["lastSidebarOpen","lastSelectedBoardId"],v=>{try{typeof v.lastSidebarOpen=="boolean"&&w(v.lastSidebarOpen),typeof v.lastSelectedBoardId=="string"&&h(v.lastSelectedBoardId)}finally{x||(x=!0,M(!0))}});return}}catch{}x||(x=!0,M(!0))},[]),l.useEffect(()=>{D&&o.length>0&&(!f||!o.some(x=>x.id===f))&&h(o[0].id)},[o,f,D]),l.useEffect(()=>{var x;try{typeof window<"u"&&window.localStorage.setItem("lastSidebarOpen",String(S)),typeof chrome<"u"&&((x=chrome.storage)!=null&&x.local)&&chrome.storage.local.set({lastSidebarOpen:S})}catch{}},[S]),l.useEffect(()=>{var x;if(f)try{typeof window<"u"&&window.localStorage.setItem("lastSelectedBoardId",f),typeof chrome<"u"&&((x=chrome.storage)!=null&&x.local)&&chrome.storage.local.set({lastSelectedBoardId:f})}catch{}},[f]),l.useEffect(()=>{document.documentElement.classList.toggle("dark",a.theme==="dark"),document.documentElement.classList.toggle("light",a.theme==="light")},[a.theme]);const je=()=>K.auth.signOut(),xe=x=>{a.openLinkIn==="current_tab"?chrome.tabs.query({active:!0,currentWindow:!0},C=>{var v;(v=C[0])!=null&&v.id?chrome.tabs.update(C[0].id,{url:x}):chrome.tabs.create({url:x})}):chrome.tabs.create({url:x})},Ee=async()=>{if(s!=null&&s.id)try{const{data:x}=await K.from("boards").select("*").eq("user_id",s.id).order("sort_order"),C=x??[],v=C.map(ft=>ft.id);if(v.length===0){wr(yr([],[]));return}const{data:E}=await K.from("categories").select("*").in("board_id",v).order("sort_order"),U=E??[],J=U.map(ft=>ft.id),{data:ae}=await K.from("bookmarks").select("*").in("category_id",J.length?J:[""]).order("sort_order"),be=ae??[],Ke=U.map(ft=>({category:ft,bookmarks:be.filter(bs=>bs.category_id===ft.id)})),Ne=yr(C,Ke);wr(Ne)}catch(x){console.error("Export failed",x)}},Qe=x=>{const C=new FileReader;C.onload=()=>{const v=C.result;if(x.name.endsWith(".json"))try{const E=JSON.parse(v);console.log("Import JSON (parse only, cha ghi Supabase):",E),alert("Import JSON:  c file. Ghi ln Supabase s b sung sau.")}catch{alert("File JSON khng hp l.")}else console.log("Import HTML (parse only, cha ghi Supabase):",v.slice(0,500)),alert("Import HTML:  c file. Ghi ln Supabase s b sung sau.")},C.readAsText(x)},ce=async(x,C)=>{if(s!=null&&s.id){if(C)await K.from("boards").update({name:x,updated_at:new Date().toISOString()}).eq("id",C);else{const v=o.length===0?0:Math.max(...o.map(E=>E.sort_order),0);await K.from("boards").insert({user_id:s.id,name:x,sort_order:v+1})}await u(),H(!1),q(null)}},He=x=>{Ue({open:!0,title:"Xa Board",message:`Bn c chc mun xa board "${x.name}"? Ton b category v bookmark trong board s b xa.`,onConfirm:async()=>{var C;await K.from("boards").delete().eq("id",x.id),f===x.id&&h(((C=o.find(v=>v.id!==x.id))==null?void 0:C.id)??null),await u(),Ue(v=>({...v,open:!1}))}})},De=async x=>{if(!(s!=null&&s.id))return;const C=o.length===0?0:Math.max(...o.map(J=>J.sort_order),0),{data:v,error:E}=await K.from("boards").insert({user_id:s.id,name:`${x.name} (bn sao)`,sort_order:C+1}).select("id").single();if(E||!v)return;const{data:U}=await K.from("categories").select("*, bookmarks(*)").eq("board_id",x.id).order("sort_order",{ascending:!0});for(const J of U??[]){const ae=J.bookmarks??[],{data:be}=await K.from("categories").insert({board_id:v.id,name:J.name,color:J.color??void 0,icon:J.icon??void 0,sort_order:J.sort_order}).select("id").single();if(be)for(const Ke of ae)await K.from("bookmarks").insert({category_id:be.id,url:Ke.url,title:Ke.title,description:Ke.description??null,tags:Ke.tags??void 0,sort_order:Ke.sort_order})}await u(),await b(),ee(null)},Me=async(x,C,v)=>{if(f){if(v)await K.from("categories").update({name:x,color:C??null,updated_at:new Date().toISOString()}).eq("id",v);else{const E=p.length===0?0:Math.max(...p.map(U=>U.sort_order),0);await K.from("categories").insert({board_id:f,name:x,color:C??null,sort_order:E+1})}await b(),I(!1),Z(null)}},it=async(x,C)=>{var U;const{data:v}=await K.from("categories").select("sort_order").eq("board_id",C).order("sort_order",{ascending:!1}).limit(1),E=((U=v==null?void 0:v[0])==null?void 0:U.sort_order)??-1;await K.from("categories").update({board_id:C,sort_order:E+1,updated_at:new Date().toISOString()}).eq("id",x),await b(),I(!1),Z(null)},Ge=x=>{Ue({open:!0,title:"Xa Category",message:`Xa category "${x.name}" v ton b bookmark bn trong?`,onConfirm:async()=>{await K.from("categories").delete().eq("id",x.id),await b(),Ue(C=>({...C,open:!1}))}})},Te=async x=>{if(!f)return;const C=p.length===0?0:Math.max(...p.map(U=>U.sort_order),0),{data:v}=await K.from("categories").insert({board_id:f,name:`${x.name} (bn sao)`,color:x.color??void 0,icon:x.icon??void 0,sort_order:C+1}).select("id").single();if(!v)return;const E=x.bookmarks??[];for(const U of E)await K.from("bookmarks").insert({category_id:v.id,url:U.url,title:U.title,description:U.description??null,tags:U.tags??void 0,sort_order:U.sort_order});await b(),W(null)},ct=async(x,C)=>{var v;if(C)await K.from("bookmarks").update({url:x.url,title:x.title,description:x.description||null,category_id:x.category_id,updated_at:new Date().toISOString()}).eq("id",C);else{const E=p.find(J=>J.id===x.category_id),U=(v=E==null?void 0:E.bookmarks)!=null&&v.length?Math.max(...E.bookmarks.map(J=>J.sort_order),0)+1:0;await K.from("bookmarks").insert({category_id:x.category_id,url:x.url,title:x.title,description:x.description||null,sort_order:U})}await b(),Ce(!1),Ve(null),Se(null)},ht=x=>{Ue({open:!0,title:"Xa Bookmark",message:`Xa "${x.title||x.url}"?`,onConfirm:async()=>{await K.from("bookmarks").delete().eq("id",x.id),await b(),Ue(C=>({...C,open:!1}))}})},Fn=async x=>{var E;const C=p.find(U=>U.id===x.category_id),v=(E=C==null?void 0:C.bookmarks)!=null&&E.length?Math.max(...C.bookmarks.map(U=>U.sort_order),0)+1:0;await K.from("bookmarks").insert({category_id:x.category_id,url:x.url,title:x.title,description:x.description??null,tags:x.tags??void 0,sort_order:v}),await b()},us=async(x,C)=>{var U;if(x.category_id===C)return;const v=p.find(J=>J.id===C),E=(U=v==null?void 0:v.bookmarks)!=null&&U.length?Math.max(...v.bookmarks.map(J=>J.sort_order),0)+1:0;await K.from("bookmarks").update({category_id:C,sort_order:E,updated_at:new Date().toISOString()}).eq("id",x.id),await b(),Je(null)},xn=x=>{Ve(null),Se(x??null),Ce(!0)},hs=(x,C)=>{x.dataTransfer.setData("text/plain",C),x.dataTransfer.effectAllowed="move",x.dataTransfer.setData("application/x-linkhub-board",C),x.dataTransfer.dropEffect="move",at(C)},fs=(x,C)=>{x.preventDefault(),x.dataTransfer.dropEffect="move",ke(C)},xs=x=>{x.preventDefault();const C=x.dataTransfer.getData("application/x-linkhub-board")||x.dataTransfer.getData("text/plain");if(!C||Oe==null){at(null),ke(null);return}const v=o.findIndex(ae=>ae.id===C);if(v===-1||v===Oe){at(null),ke(null);return}const E=[...o],[U]=E.splice(v,1);E.splice(Oe,0,U),i(E),at(null),ke(null);const J=new Date().toISOString();(async()=>{for(let ae=0;ae<E.length;ae++)await K.from("boards").update({sort_order:ae,updated_at:J}).eq("id",E[ae].id);await u()})()},ps=()=>{at(null),ke(null)},ms=Br(Pr(cn,{activationConstraint:{distance:6}})),gs=l.useCallback(x=>{const{active:C,over:v}=x;if(jt(null),!v||C.id===v.id)return;const E=p.findIndex(be=>be.id===C.id);if(E===-1)return;const U=p.findIndex(be=>be.id===v.id);if(U===-1)return;const J=hn(p,E,U);g(J);const ae=new Date().toISOString();(async()=>{for(let be=0;be<J.length;be++)await K.from("categories").update({sort_order:be,updated_at:ae}).eq("id",J[be].id)})()},[p]),zn=(x,C,v)=>{x.dataTransfer.setData("application/x-linkhub-bookmark",JSON.stringify({bookmarkId:C,categoryId:v})),x.dataTransfer.effectAllowed="move",x.dataTransfer.dropEffect="move",Ie({id:C,categoryId:v})},Hn=(x,C,v,E)=>{x.preventDefault(),x.stopPropagation(),x.dataTransfer.dropEffect="move",(we==null?void 0:we.categoryId)===v&&ze({id:C,categoryId:v,index:E})},Wn=x=>{x.preventDefault(),x.stopPropagation();const C=x.dataTransfer.getData("application/x-linkhub-bookmark");if(!C||!ot){Ie(null),ze(null);return}let v;try{v=JSON.parse(C)}catch{Ie(null),ze(null);return}if(v.categoryId!==ot.categoryId){Ie(null),ze(null);return}const E=p.find(Ne=>Ne.id===v.categoryId);if(!(E!=null&&E.bookmarks)){Ie(null),ze(null);return}const U=E.bookmarks.findIndex(Ne=>Ne.id===v.bookmarkId),J=ot.index;if(U===-1||U===J){Ie(null),ze(null);return}const ae=[...E.bookmarks],[be]=ae.splice(U,1);ae.splice(J,0,be),g(p.map(Ne=>Ne.id===v.categoryId?{...Ne,bookmarks:ae}:Ne)),Ie(null),ze(null);const Ke=new Date().toISOString();(async()=>{for(let Ne=0;Ne<ae.length;Ne++)await K.from("bookmarks").update({sort_order:Ne,updated_at:Ke}).eq("id",ae[Ne].id);await b()})()},qn=()=>{Ie(null),ze(null)};return r.jsxs("div",{className:"bg-main font-display text-text-primary h-screen overflow-hidden flex selection:bg-accent selection:text-white",children:[r.jsxs("aside",{className:`sidebar-gradient border-r border-white/10 flex flex-col z-40 w-64 flex-shrink-0 fixed inset-y-0 left-0 transform transition-transform duration-200 ${S?"translate-x-0":"-translate-x-full"}`,children:[r.jsx("div",{className:"h-12 flex items-center px-4 border-b border-white/10",children:r.jsxs("div",{className:"flex items-center gap-2 text-accent group cursor-pointer",children:[r.jsx("div",{className:"p-1.5 bg-accent/10 rounded-lg group-hover:bg-accent/20 transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"hub"})}),r.jsx("span",{className:"font-semibold text-sm tracking-tight text-white",children:"LinkHub"})]})}),r.jsxs("div",{className:"px-3 pt-2 pb-1 space-y-0.5",children:[r.jsxs("button",{type:"button",onClick:()=>G(!0),className:"flex items-center gap-2 w-full px-2.5 py-2 text-xs font-medium rounded-lg text-left text-text-secondary hover:bg-white/5 hover:text-white border border-transparent transition",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] text-accent",children:"shield"}),r.jsx("span",{children:de(a.locale).authenticator})]}),r.jsxs("button",{type:"button",onClick:()=>ne(!0),className:"flex items-center gap-2 w-full px-2.5 py-2 text-xs font-medium rounded-lg text-left text-text-secondary hover:bg-white/5 hover:text-white border border-transparent transition",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] text-accent",children:"build"}),r.jsx("span",{children:"IT Tool box"})]})]}),r.jsxs("div",{className:"px-3 pt-3 pb-1.5 flex items-center justify-between",children:[r.jsx("span",{className:"text-[12px] font-semibold uppercase text-text-muted tracking-wider",children:"Boards"}),r.jsx("button",{type:"button",onClick:()=>{q(null),H(!0)},className:"p-1 rounded-lg text-text-muted hover:text-accent hover:bg-white/5 transition","aria-label":"Add board",children:r.jsx("span",{className:"material-icons-round text-base",children:"add_circle_outline"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto px-2 space-y-0.5 pb-3",children:[c&&r.jsx("div",{className:"px-2 py-1.5 text-text-muted text-xs",children:"ang ti..."}),o.map((x,C)=>r.jsxs(V.Fragment,{children:[a.dragDrop.board&&Bt&&Oe===C&&r.jsx("div",{className:"h-1 rounded-full bg-accent shadow-[0_0_10px_rgba(129,140,248,0.7)] transition-all duration-150 mx-1 mb-0.5 flex-shrink-0","aria-hidden":!0}),r.jsxs("div",{ref:ie===x.id?lt:void 0,draggable:a.dragDrop.board,onDragStart:v=>a.dragDrop.board&&hs(v,x.id),onDragOver:v=>a.dragDrop.board&&fs(v,C),onDrop:a.dragDrop.board?xs:void 0,onDragEnd:a.dragDrop.board?ps:void 0,className:`relative transition-all duration-150 ${a.dragDrop.board?"cursor-grab active:cursor-grabbing":""} ${Bt===x.id?"opacity-40 scale-[0.98]":""}`,children:[r.jsxs("button",{ref:ie===x.id?Nt:void 0,type:"button",onClick:()=>h(x.id),className:`flex items-center justify-between w-full px-2.5 py-2 text-xs font-medium rounded-lg transition text-left ${f===x.id?"bg-accent/15 text-accent border border-accent/25 shadow-[0_0_12px_rgba(129,140,248,0.12)]":"text-text-secondary hover:bg-white/5 hover:text-white border border-transparent"}`,children:[r.jsx("span",{className:"truncate",children:x.name}),r.jsx("button",{type:"button",onClick:v=>{v.stopPropagation(),ee(E=>E===x.id?null:x.id)},className:"p-1 rounded hover:bg-white/10 flex-shrink-0","aria-label":"Menu",children:r.jsx("span",{className:"material-icons-round text-[14px] opacity-60",children:"more_horiz"})})]}),ie===x.id&&r.jsxs("div",{ref:$t,className:`absolute left-0 right-0 rounded-lg border border-white/10 bg-sidebar shadow-xl py-1 z-50 ${Ut?"bottom-full mb-0.5":"top-full mt-0.5"}`,children:[r.jsxs("button",{type:"button",onClick:()=>{q(x),H(!0),ee(null)},className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-text-secondary hover:bg-white/10 hover:text-white",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"edit"}),de(a.locale).edit]}),r.jsxs("button",{type:"button",onClick:()=>{De(x),ee(null)},className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-text-secondary hover:bg-white/10 hover:text-white",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"content_copy"}),de(a.locale).duplicate]}),r.jsxs("button",{type:"button",onClick:()=>{He(x),ee(null)},className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-red-400 hover:bg-red-500/20",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"delete"}),de(a.locale).delete]})]})]})]},x.id)),!c&&o.length===0&&r.jsx("p",{className:"px-2 py-1.5 text-text-muted text-xs",children:"Cha c board"})]})]}),r.jsxs("main",{className:`flex-1 flex flex-col min-w-0 bg-[url('https://images.unsplash.com/photo-1550684848-fac1c5b4e853?q=80&w=2070&auto=format&fit=crop')] bg-cover bg-center relative transition-[margin] duration-200 ${S?"md:ml-64":"md:ml-0"}`,children:[r.jsx("div",{className:"absolute inset-0 backdrop-blur-[2px] z-0",style:{backgroundColor:`${a.backgroundColor}E6`}}),r.jsxs("header",{className:"h-12 relative z-[100] flex items-center justify-between px-3 md:px-4 border-b border-white/10 bg-main/80 backdrop-blur-md",children:[r.jsxs("div",{className:"flex items-center flex-1 max-w-md",children:[r.jsx("button",{type:"button",onClick:()=>w(x=>!x),className:"mr-2 p-1.5 rounded-lg text-text-muted hover:text-white hover:bg-white/10 md:mr-3","aria-label":"Toggle sidebar",children:r.jsx("span",{className:"material-icons-round text-[20px]",children:S?"menu_open":"menu"})}),r.jsxs("div",{className:"relative flex-1 group",children:[r.jsx("span",{className:"material-symbols-outlined text-text-muted absolute left-3 top-1/2 -translate-y-1/2 text-[18px] transition-colors group-focus-within:text-accent",children:"search"}),r.jsx("input",{type:"text",placeholder:"Search your bookmarks...",value:m,onChange:x=>j(x.target.value),className:"bg-white/5 border border-white/10 text-xs text-white placeholder-text-muted focus:ring-2 focus:ring-accent/40 focus:border-accent/40 block w-full pl-9 pr-3 py-1.5 rounded-lg transition-all"})]})]}),r.jsxs("div",{className:"relative flex items-center gap-1.5 ml-2 md:ml-4",ref:he,children:[r.jsxs("button",{ref:zt,type:"button",onClick:()=>_(x=>!x),className:"flex items-center gap-2 pl-1.5 pr-2.5 py-1.5 rounded-lg transition bg-white/5 hover:bg-white/10 border border-transparent hover:border-white/10",children:[r.jsx("div",{className:"h-7 w-7 rounded-full bg-accent/20 flex items-center justify-center text-accent font-semibold text-xs ring-1 ring-white/10",children:((Jn=s==null?void 0:s.email)==null?void 0:Jn.slice(0,1).toUpperCase())??"?"}),r.jsxs("div",{className:"flex flex-col items-start max-w-[120px]",children:[r.jsx("span",{className:"text-xs font-medium text-white leading-tight truncate w-full",children:((Kn=s==null?void 0:s.user_metadata)==null?void 0:Kn.full_name)??(s==null?void 0:s.email)??"User"}),r.jsx("span",{className:"text-[11px] text-text-muted leading-tight",children:"Member"})]}),r.jsx("span",{className:`material-icons-round text-text-muted text-lg transition-transform ${B?"rotate-180":""}`,children:"expand_more"})]}),B&&r.jsxs("div",{ref:Ft,className:`absolute right-0 w-48 rounded-lg border border-white/10 bg-sidebar shadow-xl shadow-black/40 py-1 z-[110] overflow-hidden ${fe?"bottom-full mb-1.5":"top-full mt-1.5"}`,children:[r.jsxs("div",{className:"px-3 py-2 border-b border-white/10",children:[r.jsx("p",{className:"text-[11px] font-medium text-text-muted uppercase tracking-wider",children:de(a.locale).signedInAs}),r.jsx("p",{className:"text-xs font-medium text-white truncate mt-0.5",children:s==null?void 0:s.email})]}),r.jsxs("button",{type:"button",onClick:()=>{L(!0),_(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-left text-xs text-text-secondary hover:bg-white/10 hover:text-white transition",children:[r.jsx("span",{className:"material-symbols-outlined text-base text-accent",children:"settings"}),de(a.locale).settings]}),r.jsxs("button",{type:"button",onClick:()=>{je(),_(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-left text-xs text-text-secondary hover:bg-red-500/20 hover:text-red-400 transition",children:[r.jsx("span",{className:"material-symbols-outlined text-base",children:"logout"}),de(a.locale).logOut]})]})]})]}),r.jsx("div",{className:"px-4 py-3 z-10 flex items-center justify-between",children:r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>{Z(null),I(!0)},disabled:!f||o.length===0,title:o.length===0?de(a.locale).createBoardFirst:void 0,className:"glass-panel text-white hover:bg-accent hover:border-accent text-xs font-medium px-3 py-2 rounded-lg transition-all flex items-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"add"}),de(a.locale).createCategory]}),r.jsxs("button",{type:"button",onClick:()=>xn(),className:"glass-panel text-text-secondary hover:text-white hover:bg-white/10 text-xs font-medium px-3 py-2 rounded-lg transition flex items-center gap-1.5",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"link"}),de(a.locale).addBookmark]})]})}),r.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-6 z-10",children:[d&&r.jsx("p",{className:"text-red-400 text-xs py-3",children:d.message}),se&&r.jsxs("div",{className:"py-3",children:[T&&r.jsx("p",{className:"text-text-muted text-xs",children:"ang tm kim..."}),!T&&me&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-[11px] font-semibold uppercase text-text-muted tracking-wider mb-1",children:"Boards"}),me.boardMatches.length===0?r.jsx("p",{className:"text-xs text-text-muted/70",children:"Khng c board ph hp."}):r.jsx("ul",{className:"space-y-1.5",children:me.boardMatches.map(x=>r.jsx("li",{children:r.jsxs("button",{type:"button",onClick:()=>{h(x.id),j("")},className:"w-full text-left px-3 py-1.5 rounded-lg bg-white/5 hover:bg-accent/20 text-xs text-white/90 transition flex items-center justify-between",children:[r.jsx("span",{className:"truncate",children:x.name}),r.jsx("span",{className:"text-[11px] text-text-muted ml-2",children:"Board"})]})},x.id))})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-[11px] font-semibold uppercase text-text-muted tracking-wider mb-1",children:"Categories"}),me.categoryMatches.length===0?r.jsx("p",{className:"text-xs text-text-muted/70",children:"Khng c category ph hp."}):r.jsx("ul",{className:"space-y-1.5",children:me.categoryMatches.map(x=>{const C=o.find(v=>v.id===x.board_id);return r.jsx("li",{children:r.jsxs("button",{type:"button",onClick:()=>{h(x.board_id),j("")},className:"w-full text-left px-3 py-1.5 rounded-lg bg-white/5 hover:bg-accent/20 text-xs text-white/90 transition flex items-center justify-between",children:[r.jsx("span",{className:"truncate",children:x.name}),r.jsx("span",{className:"text-[11px] text-text-muted ml-2 truncate max-w-[160px]",children:(C==null?void 0:C.name)??"Board"})]})},x.id)})})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-[11px] font-semibold uppercase text-text-muted tracking-wider mb-1",children:"Bookmarks"}),me.bookmarkMatches.length===0?r.jsx("p",{className:"text-xs text-text-muted/70",children:"Khng c bookmark ph hp."}):r.jsx("ul",{className:"space-y-1.5",children:me.bookmarkMatches.map(x=>{const C=R.find(E=>E.id===x.category_id),v=C?o.find(E=>E.id===C.board_id):void 0;return r.jsx("li",{children:r.jsxs("button",{type:"button",onClick:()=>xe(x.url),className:"w-full text-left px-3 py-1.5 rounded-lg bg-white/5 hover:bg-accent/20 text-xs text-white/90 transition flex flex-col items-start",children:[r.jsx("span",{className:"truncate",children:x.title||x.url}),r.jsxs("span",{className:"text-[11px] text-text-muted truncate max-w-full mt-0.5",children:[v!=null&&v.name?`${v.name}  `:"",(C==null?void 0:C.name)??""]})]})},x.id)})})]})]})]}),!se&&r.jsxs(r.Fragment,{children:[N&&r.jsx("div",{className:"text-text-muted text-xs py-6",children:"ang ti categories..."}),!N&&p.length===0&&f&&r.jsxs("div",{className:"text-text-muted text-xs py-6 text-center",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl block mb-1.5 opacity-50",children:"folder_open"}),r.jsx("p",{children:"Cha c category. To category hoc thm bookmark."})]}),r.jsx("div",{className:`gap-2 space-y-2 columns-1 ${a.categoryColumns===2?"md:columns-2":a.categoryColumns===3?"md:columns-3":a.categoryColumns===5?"md:columns-5":a.categoryColumns===6?"md:columns-6":"md:columns-4"}`,children:a.dragDrop.category?r.jsxs(ns,{sensors:ms,collisionDetection:$r,onDragStart:({active:x})=>jt(x.id),onDragEnd:gs,children:[r.jsx(os,{items:p.map(x=>x.id),strategy:Un,children:p.map((x,C)=>r.jsx(Fl,{category:x,activeCategoryId:Fe,fallbackDotColor:xt[C%xt.length],searchQuery:m,onOpenBookmark:xe,cardHeight:a.categoryCardHeight,fillContent:a.categoryColorFillContent,categoryMenuId:oe,onOpenCategoryMenu:v=>W(E=>E===v?null:v),onEditCategory:()=>{Z(x),I(!0),W(null)},onDuplicateCategory:()=>{Te(x),W(null)},onDeleteCategory:()=>{Ge(x),W(null)},onAddBookmark:()=>{xn(x.id),W(null)},onEditBookmark:v=>{Ve(v),Ce(!0),W(null)},onDuplicateBookmark:Fn,onMoveBookmark:v=>Je(v),onDeleteBookmark:ht,dragDropBookmark:a.dragDrop.bookmark,draggedBookmark:we,dropBookmarkTarget:ot,onBookmarkDragStart:(v,E)=>zn(v,E,x.id),onBookmarkDragOver:(v,E,U)=>Hn(v,E,x.id,U),onBookmarkDrop:Wn,onBookmarkDragEnd:qn},x.id))}),r.jsx(ol,{dropAnimation:{duration:200,easing:"ease"},children:Fe?(()=>{const x=p.find(v=>v.id===Fe);if(!x)return null;const C=p.findIndex(v=>v.id===Fe);return r.jsx("div",{className:"cursor-grabbing opacity-95 shadow-xl rounded-xl overflow-hidden w-[240px]",children:r.jsx(Rn,{category:x,fallbackDotColor:xt[C%xt.length],searchQuery:m,onOpenBookmark:xe,cardHeight:a.categoryCardHeight,fillContent:a.categoryColorFillContent,categoryMenuId:null,onOpenCategoryMenu:()=>{},onEditCategory:()=>{},onDeleteCategory:()=>{},onAddBookmark:()=>{},onEditBookmark:()=>{},onDeleteBookmark:()=>{},dragDropCategory:!1,sortableWrapper:!1,dragDropBookmark:!1,draggedBookmark:null,dropBookmarkTarget:null,onBookmarkDragStart:void 0,onBookmarkDragOver:void 0,onBookmarkDrop:void 0,onBookmarkDragEnd:void 0})})})():null})]}):p.map((x,C)=>r.jsx(Rn,{category:x,fallbackDotColor:xt[C%xt.length],searchQuery:m,onOpenBookmark:xe,cardHeight:a.categoryCardHeight,fillContent:a.categoryColorFillContent,categoryMenuId:oe,onOpenCategoryMenu:v=>W(E=>E===v?null:v),onEditCategory:()=>{Z(x),I(!0),W(null)},onDuplicateCategory:()=>{Te(x),W(null)},onDeleteCategory:()=>{Ge(x),W(null)},onAddBookmark:()=>{xn(x.id),W(null)},onEditBookmark:v=>{Ve(v),Ce(!0),W(null)},onDuplicateBookmark:Fn,onMoveBookmark:v=>Je(v),onDeleteBookmark:ht,dragDropCategory:!1,sortableWrapper:!1,dragDropBookmark:a.dragDrop.bookmark,draggedBookmark:we,dropBookmarkTarget:ot,onBookmarkDragStart:(v,E)=>zn(v,E,x.id),onBookmarkDragOver:(v,E,U)=>Hn(v,E,x.id,U),onBookmarkDrop:Wn,onBookmarkDragEnd:qn},x.id))})]})]})]}),r.jsx(vl,{open:z,onClose:()=>L(!1),onExportHtml:Ee,onImportFile:Qe}),r.jsx(Dl,{open:Q,onClose:()=>ne(!1)}),r.jsx(Tl,{open:ye,onClose:()=>G(!1),userId:s==null?void 0:s.id}),r.jsx(yl,{open:re,editBoard:P,onClose:()=>{H(!1),q(null)},onSave:ce}),r.jsx(Bl,{open:$,boardId:f,editCategory:te?{id:te.id,name:te.name,color:te.color??null,bg_opacity:te.bg_opacity??null,board_id:te.board_id}:null,boards:o,onClose:()=>{I(!1),Z(null)},onSave:Me,onMoveToBoard:it}),r.jsx($l,{open:Ye||Y,categories:p,editBookmark:Pt,initialUrl:(e==null?void 0:e.url)??"",initialTitle:(e==null?void 0:e.title)??"",defaultCategoryId:wt,onClose:()=>{Ce(!1),F(!1),Ve(null),Se(null)},onSave:ct}),r.jsx(Ul,{open:st.open,title:st.title,message:st.message,onConfirm:st.onConfirm,onCancel:()=>Ue(x=>({...x,open:!1}))}),r.jsx(Hl,{open:!!qe,bookmark:qe,boards:o,onClose:()=>Je(null),onMove:x=>qe&&us(qe,x)})]})}function Hl({open:e,bookmark:t,boards:n,onClose:s,onMove:a}){const[o,i]=l.useState([]),[c,d]=l.useState(!1),u=n.map(p=>p.id).join(",");if(l.useEffect(()=>{if(!e||!t||n.length===0){i([]);return}let p=!1;return d(!0),(async()=>{const g=n.map(b=>b.id),{data:N}=await K.from("categories").select("id, name, board_id, sort_order").in("board_id",g).order("sort_order",{ascending:!0});!p&&N&&i(N??[]),d(!1)})(),()=>{p=!0}},[e,t==null?void 0:t.id,u]),!e)return null;const h=[...n].sort((p,g)=>p.sort_order-g.sort_order).map(p=>({board:p,categories:o.filter(g=>g.board_id===p.id).sort((g,N)=>g.sort_order-N.sort_order)}));return r.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s,children:r.jsxs("div",{className:"bg-sidebar border border-white/10 rounded-xl shadow-xl w-full max-w-sm max-h-[80vh] flex flex-col overflow-hidden",onClick:p=>p.stopPropagation(),children:[r.jsx("h3",{className:"text-base font-semibold text-white px-4 py-3 border-b border-white/10",children:"Di chuyn bookmark"}),t&&r.jsx("p",{className:"px-4 py-1.5 text-xs text-text-muted truncate border-b border-white/5",children:t.title||t.url}),r.jsx("div",{className:"overflow-y-auto flex-1 p-2 min-h-0",children:c?r.jsx("p",{className:"text-xs text-text-muted py-4 text-center",children:"ang ti..."}):h.map(({board:p,categories:g})=>r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-[11px] font-semibold uppercase text-text-muted tracking-wider px-2 py-1",children:p.name}),r.jsxs("div",{className:"space-y-0.5",children:[g.map(N=>{const b=(t==null?void 0:t.category_id)===N.id;return r.jsxs("button",{type:"button",disabled:b,onClick:()=>{a(N.id),s()},className:`flex items-center gap-2 w-full px-3 py-2 rounded-lg text-left text-xs transition ${b?"opacity-50 cursor-not-allowed bg-white/5 text-text-muted":"text-text-secondary hover:bg-white/10 hover:text-white"}`,children:[r.jsx("span",{className:"font-medium truncate",children:N.name}),b&&r.jsx("span",{className:"text-[11px] text-text-muted flex-shrink-0",children:"(hin ti)"})]},N.id)}),g.length===0&&r.jsx("p",{className:"px-3 py-1.5 text-xs text-text-muted",children:"Cha c category"})]})]},p.id))}),r.jsx("div",{className:"p-2 border-t border-white/10",children:r.jsx("button",{type:"button",onClick:s,className:"w-full px-3 py-2 rounded-lg text-xs border border-white/10 text-text-secondary hover:bg-white/10",children:"Hy"})})]})})}function Rn({category:e,fallbackDotColor:t,searchQuery:n,onOpenBookmark:s,cardHeight:a,fillContent:o,categoryMenuId:i,onOpenCategoryMenu:c,onEditCategory:d,onDuplicateCategory:u,onDeleteCategory:f,onAddBookmark:h,onEditBookmark:p,onDuplicateBookmark:g,onMoveBookmark:N,onDeleteBookmark:b,dragDropCategory:m,sortableWrapper:j=!1,isDraggingCategory:S,dragDropBookmark:w,draggedBookmark:D,dropBookmarkTarget:M,onBookmarkDragStart:R,onBookmarkDragOver:O,onBookmarkDrop:y,onBookmarkDragEnd:k}){const T=dt(),{id:A,name:Y,color:F,icon:z,bookmarks:L}=e,B=F||t,_=n?L.filter(Q=>{var ne,P;return((ne=Q.title)==null?void 0:ne.toLowerCase().includes(n.toLowerCase()))||((P=Q.url)==null?void 0:P.toLowerCase().includes(n.toLowerCase()))}):L,he=i===A,re=l.useRef(null),H=l.useRef(null),[ye,G]=l.useState(!1);return l.useEffect(()=>{if(!he)return;const ne=requestAnimationFrame(()=>{const P=re.current,q=H.current;if(!P||!q)return;const ie=P.getBoundingClientRect(),ee=q.getBoundingClientRect(),$=window.innerHeight-ie.bottom,I=ie.top>ee.height,te=$<ee.height,Z=_.length<=2;G(Z&&I||te&&I)});return()=>cancelAnimationFrame(ne)},[he]),r.jsxs("div",{"data-category-menu":!0,className:`relative glass-panel rounded-xl ${he&&ye?"overflow-visible":"overflow-hidden"} shadow-glass group hover:border-white/10 transition-all duration-200 ${a==="equal"?"min-h-[240px] flex flex-col":""} ${m||j?"cursor-grab active:cursor-grabbing":""} ${S?"opacity-40 scale-[0.98]":""} ${he?"z-[999]":""}`,style:F&&o?{backgroundColor:F,backgroundImage:"none"}:void 0,children:[r.jsxs("div",{className:"px-2.5 py-0 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",style:F?{backgroundColor:F}:void 0,children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[z?r.jsx("span",{className:"material-symbols-outlined text-[16px] text-white",children:z}):r.jsx("div",{className:"h-1.5 w-1.5 rounded-full flex-shrink-0",style:{backgroundColor:B,boxShadow:`0 0 6px ${B}80`}}),r.jsx("h3",{className:"font-bold text-xs text-white tracking-wide",children:Y})]}),r.jsxs("div",{ref:re,className:"relative",children:[r.jsx("button",{type:"button",onClick:Q=>{Q.stopPropagation(),c(A)},className:"text-text-muted hover:text-white transition opacity-0 group-hover:opacity-100 p-1 rounded","aria-label":"More",children:r.jsx("span",{className:"material-icons-round text-base",children:"more_horiz"})}),he&&r.jsxs("div",{ref:H,className:`absolute right-0 rounded-lg border border-white/10 bg-sidebar shadow-xl py-1 z-[999] min-w-[180px] whitespace-nowrap ${ye?"bottom-full mb-0.5":"top-full mt-0.5"}`,children:[r.jsxs("button",{type:"button",onClick:d,className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-text-secondary hover:bg-white/10 hover:text-white",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"edit"}),de(T.locale).edit]}),r.jsxs("button",{type:"button",onClick:h,className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-text-secondary hover:bg-white/10 hover:text-white",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"link"}),de(T.locale).addBookmark]}),u&&r.jsxs("button",{type:"button",onClick:u,className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-text-secondary hover:bg-white/10 hover:text-white",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"content_copy"}),de(T.locale).duplicate]}),r.jsxs("button",{type:"button",onClick:f,className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-red-400 hover:bg-red-500/20",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"delete"}),de(T.locale).delete]})]})]})]}),r.jsx("ul",{className:`py-1.5 px-1 ${a==="equal"?"flex-1 flex flex-col":""}`,children:_.length===0?r.jsx("li",{className:"p-6 flex items-center justify-center text-text-muted/30",children:r.jsx("span",{className:"material-symbols-outlined text-3xl",children:"folder_open"})}):_.map((Q,ne)=>r.jsx(Wl,{bookmark:Q,index:ne,onOpen:s,onEdit:p,onDuplicate:g,onMove:N,onDelete:b,dragDropEnabled:w,isDragging:(D==null?void 0:D.id)===Q.id&&(D==null?void 0:D.categoryId)===A,isDropTarget:(M==null?void 0:M.categoryId)===A&&(M==null?void 0:M.index)===ne,onDragStart:P=>R==null?void 0:R(P,Q.id),onDragOver:P=>O==null?void 0:O(P,Q.id,ne),onDrop:y,onDragEnd:k},Q.id))})]})}function Wl({bookmark:e,index:t,onOpen:n,onEdit:s,onDuplicate:a,onMove:o,onDelete:i,dragDropEnabled:c,isDragging:d,isDropTarget:u,onDragStart:f,onDragOver:h,onDrop:p,onDragEnd:g}){const[N,b]=l.useState(!1),[m,j]=l.useState(null),[S,w]=l.useState({top:0,left:0}),D=l.useRef(null),M=l.useRef(null),R=()=>{var T;const k=(T=D.current)==null?void 0:T.getBoundingClientRect();k&&(j(k),w({top:k.bottom+2,left:k.right-160})),b(!0)},O=()=>{b(!1),j(null)};l.useEffect(()=>{if(!N)return;const k=T=>{var Y,F;const A=T.target;(Y=D.current)!=null&&Y.contains(A)||(F=M.current)!=null&&F.contains(A)||O()};return document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[N]),l.useLayoutEffect(()=>{if(!N||!m||!M.current)return;const T=M.current.getBoundingClientRect(),F=window.innerHeight-m.bottom<T.height?m.top-T.height-2:m.bottom+2,z=m.right-T.width;w({top:F,left:z})},[N,m]);const y=N&&m&&r.jsxs("div",{ref:M,className:"rounded-lg border border-white/10 bg-sidebar shadow-xl py-1 min-w-[160px] whitespace-nowrap",style:{position:"fixed",top:S.top,left:S.left,zIndex:9999},children:[r.jsxs("button",{type:"button",onClick:()=>{s(e),O()},className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-text-secondary hover:bg-white/10 hover:text-white",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"edit"}),de(dt().locale).edit]}),a&&r.jsxs("button",{type:"button",onClick:()=>{a(e),O()},className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-text-secondary hover:bg-white/10 hover:text-white",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"content_copy"}),de(dt().locale).duplicate]}),o&&r.jsxs("button",{type:"button",onClick:()=>{o(e),O()},className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-text-secondary hover:bg-white/10 hover:text-white",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"drive_file_move"}),"Di chuyn"]}),r.jsxs("button",{type:"button",onClick:()=>{i(e),O()},className:"flex items-center gap-1.5 w-full px-2.5 py-1.5 text-left text-xs text-red-400 hover:bg-red-500/20",children:[r.jsx("span",{className:"material-icons-round text-[16px]",children:"delete"}),de(dt().locale).delete]})]});return r.jsxs("li",{className:"relative",children:[u&&r.jsx("div",{className:"absolute left-2 right-2 top-0 h-1 rounded-full bg-accent shadow-[0_0_8px_rgba(129,140,248,0.6)] z-10 pointer-events-none","aria-hidden":!0}),r.jsxs("div",{ref:D,draggable:c,onDragStart:c?f:void 0,onDragOver:c?h:void 0,onDrop:c?p:void 0,onDragEnd:c?g:void 0,className:`relative flex items-center group/item transition-all duration-150 ${c?"cursor-grab active:cursor-grabbing":""} ${d?"opacity-40 scale-[0.98]":""}`,children:[r.jsxs("button",{type:"button",onClick:()=>n(e.url),className:"flex items-center gap-2 px-3 py-2 mx-0.5 rounded-lg hover:bg-white/10 transition-all duration-200 w-full text-left flex-1 min-w-0",children:[r.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center bg-slate-800 text-text-secondary text-[11px] font-bold border border-white/5 group-hover/item:border-accent/30 group-hover/item:text-accent transition-colors flex-shrink-0",children:t+1}),r.jsx("span",{className:"text-xs font-medium text-text-secondary group-hover/item:text-white transition-colors truncate",children:e.title||e.url})]}),r.jsx("button",{type:"button",onClick:k=>{k.stopPropagation(),N?O():R()},className:"p-1 rounded text-text-muted hover:text-white opacity-0 group-hover/item:opacity-100 transition absolute right-1.5","aria-label":"Menu",children:r.jsx("span",{className:"material-icons-round text-[14px]",children:"more_vert"})})]}),y&&pt.createPortal(y,document.body)]})}function ql(){const[e,t]=l.useState(""),[n,s]=l.useState(""),[a,o]=l.useState(null),[i,c]=l.useState(!1),d=sn(),u=async f=>{f.preventDefault(),o(null),c(!0);try{const{error:h}=await K.auth.signInWithPassword({email:e,password:n});if(h)throw h;d("/",{replace:!0})}catch(h){o(h instanceof Error?h.message:"ng nhp tht bi")}finally{c(!1)}};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:r.jsxs("div",{className:"w-full max-w-sm rounded-xl bg-white dark:bg-gray-800 shadow-lg p-4",children:[r.jsx("h1",{className:"text-base font-semibold text-center text-gray-900 dark:text-white mb-3",children:"ng nhp LinkHub"}),r.jsxs("form",{onSubmit:u,className:"space-y-2.5",children:[r.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:f=>t(f.target.value),required:!0,className:"w-full py-1.5 px-3 rounded-lg text-sm border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),r.jsx("input",{type:"password",placeholder:"Mt khu",value:n,onChange:f=>s(f.target.value),required:!0,className:"w-full py-1.5 px-3 rounded-lg text-sm border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),a&&r.jsx("p",{className:"text-xs text-red-600",children:a}),r.jsx("button",{type:"submit",disabled:i,className:"w-full py-1.5 rounded-lg text-xs bg-primary-600 hover:bg-primary-700 text-white font-medium disabled:opacity-50",children:i?"ang ng nhp...":"ng nhp"})]}),r.jsxs("p",{className:"mt-3 text-center text-xs text-gray-500",children:["Cha c ti khon? ",r.jsx(Tr,{to:"/register",className:"text-primary-600 hover:underline",children:"ng k"})]})]})})}function Jl(){const[e,t]=l.useState(""),[n,s]=l.useState(""),[a,o]=l.useState(null),[i,c]=l.useState(!1),d=sn(),u=async f=>{f.preventDefault(),o(null),c(!0);try{const{error:h}=await K.auth.signUp({email:e,password:n});if(h)throw h;d("/",{replace:!0})}catch(h){o(h instanceof Error?h.message:"ng k tht bi")}finally{c(!1)}};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:r.jsxs("div",{className:"w-full max-w-sm rounded-xl bg-white dark:bg-gray-800 shadow-lg p-4",children:[r.jsx("h1",{className:"text-base font-semibold text-center text-gray-900 dark:text-white mb-3",children:"ng k LinkHub"}),r.jsxs("form",{onSubmit:u,className:"space-y-2.5",children:[r.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:f=>t(f.target.value),required:!0,className:"w-full py-1.5 px-3 rounded-lg text-sm border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),r.jsx("input",{type:"password",placeholder:"Mt khu",value:n,onChange:f=>s(f.target.value),required:!0,className:"w-full py-1.5 px-3 rounded-lg text-sm border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),a&&r.jsx("p",{className:"text-xs text-red-600",children:a}),r.jsx("button",{type:"submit",disabled:i,className:"w-full py-1.5 rounded-lg text-xs bg-primary-600 hover:bg-primary-700 text-white font-medium disabled:opacity-50",children:i?"ang ng k...":"ng k"})]}),r.jsxs("p",{className:"mt-3 text-center text-xs text-gray-500",children:[" c ti khon? ",r.jsx(Tr,{to:"/login",className:"text-primary-600 hover:underline",children:"ng nhp"})]})]})})}function Kl(){const{session:e,loading:t}=Nr(),[n,s]=l.useState(null),[a,o]=l.useState(!1),[i,c]=l.useState(!1);return l.useEffect(()=>{const d=new URLSearchParams(window.location.search);d.get("add")==="1"&&s({url:d.get("url")??"",title:d.get("title")??""}),d.get("open")==="authenticator"&&o(!0),d.get("open")==="it-tools"&&c(!0)},[]),t?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:r.jsx("div",{className:"animate-pulse text-gray-500",children:"ang ti..."})}):r.jsx(ks,{children:r.jsxs(ba,{children:[r.jsx(Ct,{path:"/login",element:e?r.jsx(Ht,{to:"/",replace:!0}):r.jsx(ql,{})}),r.jsx(Ct,{path:"/register",element:e?r.jsx(Ht,{to:"/",replace:!0}):r.jsx(Jl,{})}),r.jsx(Ct,{path:"/",element:e?r.jsx(zl,{initialAddBookmark:n??void 0,initialOpenAuthenticator:a,initialOpenItTools:i}):r.jsx(Ht,{to:"/login",replace:!0})}),r.jsx(Ct,{path:"*",element:r.jsx(Ht,{to:"/",replace:!0})})]})})}ys.createRoot(document.getElementById("root")).render(r.jsx(V.StrictMode,{children:r.jsx(Sa,{children:r.jsx(Kl,{})})}));
